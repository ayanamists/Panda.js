<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://pic.superbed.cc/item/656efcb312f8d922c1008d4a.png"/><link rel="stylesheet" href="/_next/static/css/c6bd041446e6519a.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/ad2762ca96cee671.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/d0ab39c2387d2115.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-f70da49b2a689e16.js"/><script src="/_next/static/chunks/1dd3208c-0a1ade3a7807b4cc.js" async=""></script><script src="/_next/static/chunks/286-ccdecb91557a793d.js" async=""></script><script src="/_next/static/chunks/main-app-1543724a55492158.js" async=""></script><script src="/_next/static/chunks/706-97ed238ee5a03fb5.js" async=""></script><script src="/_next/static/chunks/469-7ee2e4c850f58403.js" async=""></script><script src="/_next/static/chunks/911-e9f556f9b03e931c.js" async=""></script><script src="/_next/static/chunks/373-fbdb9516436dc720.js" async=""></script><script src="/_next/static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js" async=""></script><script src="/_next/static/chunks/61af6f7f-9cff01d0fc100f98.js" async=""></script><script src="/_next/static/chunks/861-2893a7c032654c11.js" async=""></script><script src="/_next/static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-adf657eca4f78e61.js" async=""></script><title>Aya&#x27;s Blog</title><meta name="description" content="A site powered by next.js and pandoc"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="text-foreground bg-background min-h-screen"><div data-overlay-container="true"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav class="flex z-40 w-full h-auto items-center justify-center data-[menu-open=true]:border-none sticky top-0 inset-x-0 backdrop-blur-lg data-[menu-open=true]:backdrop-blur-xl backdrop-saturate-150 bg-background/70" style="--navbar-height:4rem;transform:none"><header class="z-40 flex px-6 gap-4 w-full flex-row relative flex-nowrap items-center justify-between h-[var(--navbar-height)] max-w-[1024px]"><div class="basis-0 flex-grow flex-nowrap justify-start bg-transparent items-center no-underline text-medium whitespace-nowrap box-border flex flex-row gap-4"><p class="font-bold text-inherit"><a aria-label="Home" href="/en">Home</a></p><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"><a class="font-bold" aria-label="Blog" href="/en/blog">Blog</a></li><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"><a class="font-bold" aria-label="Favorites" href="/en/favorites">Favorites</a></li></div><ul class="flex h-full flex-row flex-nowrap items-center data-[justify=start]:justify-start data-[justify=start]:flex-grow data-[justify=start]:basis-0 data-[justify=center]:justify-center data-[justify=end]:justify-end data-[justify=end]:flex-grow data-[justify=end]:basis-0 gap-1" data-justify="end"><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"><button class="group relative inline-flex items-center justify-center box-border appearance-none select-none whitespace-nowrap overflow-hidden tap-highlight-transparent outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 gap-2 rounded-medium px-0 !gap-0 data-[pressed=true]:scale-[0.97] transition-transform-colors-opacity motion-reduce:transition-none bg-transparent text-default-foreground data-[hover=true]:bg-default/40 min-w-10 w-10 h-10 z-10 aria-expanded:scale-[0.97] aria-expanded:opacity-70 subpixel-antialiased text-md font-bold" type="button" aria-label="Select Language" data-slot="trigger" id="react-aria-:R1j6fja:" aria-haspopup="true" aria-expanded="false">æ–‡/A</button></li><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"></li></ul></header></nav><div class=" relative w-full py-12 shadow-xl shadow-slate-700/20 ring-1 ring-gray-900/5 dark:shadow-slate-100/20 dark:ring-gray-100/5 lg:mx-auto lg:max-w-4xl lg:pt-16 lg:pb-28"><div class="prose prose-natural dark:prose-invert mx-auto max-w-full px-8 sm:px-16 relative"><div><h1 class="text-4xl font-bold mb-2">Enabling Line Number Display in coq-mode</h1><div class="text-sm text-gray-500 mb-5">12/4/2023</div><div class="xl:absolute xl:-right-8"><div class="xl:fixed xl:max-w-[300px]"><div class="toc"><ul><li><a href="#what-is-the-problem" id="toc-what-is-the-problem">What<!-- --> <!-- -->is<!-- --> <!-- -->the<!-- --> <!-- -->problem</a></li><li><a href="#temporary-solution" id="toc-temporary-solution">Temporary<!-- --> <!-- -->Solution</a></li><li><a href="#why" id="toc-why">Why</a></li><li><a href="#final-solution" id="toc-final-solution">Final<!-- --> <!-- -->Solution</a></li></ul></div></div></div><article><div class="border-l-4 border-l-primary shadow-md rounded-xl mb-3 mt-3"><div class="pl-4 pr-3"><div class="pt-3"><div class="flex items-center font-bold gap-2"><span class="text-3xl"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g id="Warning"><g><g><path d="M12.5,8.752a.5.5,0,0,0-1,0h0v6a.5.5,0,0,0,1,0Z"></path><circle cx="11.999" cy="16.736" r="0.5"></circle></g><path d="M18.642,20.934H5.385A2.5,2.5,0,0,1,3.163,17.29L9.792,4.421a2.5,2.5,0,0,1,4.444,0L20.865,17.29a2.5,2.5,0,0,1-2.223,3.644ZM12.014,4.065a1.478,1.478,0,0,0-1.334.814L4.052,17.748a1.5,1.5,0,0,0,1.333,2.186H18.642a1.5,1.5,0,0,0,1.334-2.186L13.348,4.879A1.478,1.478,0,0,0,12.014,4.065Z"></path></g></g></svg></span>WARNING</div></div><div class="pb-3 pt-3"><p class="first:mt-0 last:mb-0 ">This<!-- --> <!-- -->article<!-- --> <!-- -->was<!-- --> <!-- -->translated<!-- --> <!-- -->from<!-- --> <!-- -->Chinese<!-- --> <!-- -->by<!-- --> <!-- -->ChatGPT<!-- --> <!-- -->and<!-- --> <!-- -->may<!-- --> <!-- -->contain<!-- --> <!-- -->some<!-- --> <!-- -->errors.</p></div></div></div><p>The<!-- --> <!-- -->display<!-- --> <!-- -->of<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->(Line<!-- --> <!-- -->Number)<!-- --> <!-- -->should<!-- --> <!-- -->not<!-- --> <!-- -->be<!-- --> <!-- -->a<!-- --> <!-- -->problem.<!-- --> <!-- -->There<!-- --> <!-- -->is<!-- --> <!-- -->even<!-- --> <!-- -->an<!-- --> <a href="https://github.com/Microsoft/vscode/issues/52735">issue</a> <!-- -->in<!-- --> <!-- -->the<!-- --> <!-- -->vscode<!-- --> <!-- -->repository<!-- --> <!-- -->asking<!-- --> <!-- -->how<!-- --> <!-- -->to<!-- --> <!-- -->conveniently<!-- --> <!-- -->turn<!-- --> <!-- -->off<!-- --> <!-- -->the<!-- --> <!-- -->line<!-- --> <!-- -->number<!-- --> <!-- -->display.<!-- --> <!-- -->For<!-- --> <!-- -->Vim<!-- --> <!-- -->users,<!-- --> <!-- -->a<!-- --> <!-- -->simple<!-- --> <code>set :number</code> <!-- -->can<!-- --> <!-- -->turn<!-- --> <!-- -->on<!-- --> <!-- -->the<!-- --> <!-- -->line<!-- --> <!-- -->number<!-- --> <!-- -->display.</p><p>Yes,<!-- --> <!-- -->Emacs<!-- --> <!-- -->is<!-- --> <!-- -->such<!-- --> <!-- -->a<!-- --> <!-- -->special<!-- --> <!-- -->editor.<!-- --> <!-- -->For<!-- --> <!-- -->occasional<!-- --> <!-- -->users<!-- --> <!-- -->like<!-- --> <!-- -->me,<!-- --> <!-- -->the<!-- --> <!-- -->display<!-- --> <!-- -->of<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->is<!-- --> <!-- -->indeed<!-- --> <!-- -->a<!-- --> <!-- -->problem<!-- --> <!-- -->that<!-- --> <!-- -->troubles<!-- --> <!-- -->me.</p><h2 class="text-3xl" id="what-is-the-problem"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#what-is-the-problem">#</a>What<!-- --> <!-- -->is<!-- --> <!-- -->the<!-- --> <!-- -->problem</h2><p>I<!-- --> <!-- -->am<!-- --> <!-- -->using<!-- --> <!-- -->a<!-- --> <!-- -->distribution<!-- --> <!-- -->of<!-- --> <!-- -->Emacs,<!-- --> <!-- -->or<!-- --> <!-- -->a<!-- --> <!-- -->mature<!-- --> <!-- -->configuration<!-- --> <!-- -->file,<!-- --> <a href="https://www.spacemacs.org/">Spacemacs</a>.<!-- --> <!-- -->In<!-- --> <!-- -->the<!-- --> <!-- -->official<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->documentation,<!-- --> <!-- -->to<!-- --> <!-- -->enable<!-- --> <!-- -->line<!-- --> <!-- -->number<!-- --> <!-- -->display,<!-- --> <!-- -->you<!-- --> <!-- -->only<!-- --> <!-- -->need<!-- --> <!-- -->to<!-- --> <!-- -->set<!-- --> <!-- -->a<!-- --> <!-- -->variable<!-- --> <!-- -->in<!-- --> <code>.spacemacs</code>:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">setq-default</span><span> dotspacemacs-line-numbers </span><span class="token" style="color:hsl(29, 54%, 61%)">t</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>The<!-- --> <!-- -->meaning<!-- --> <!-- -->of<!-- --> <!-- -->this<!-- --> <!-- -->sentence<!-- --> <!-- -->is<!-- --> <!-- -->to<!-- --> <!-- -->set<!-- --> <code>dotspacemacs-line-numbers</code> <!-- -->to<!-- --> <code>t</code>.</p><p>At<!-- --> <!-- -->the<!-- --> <!-- -->same<!-- --> <!-- -->time,<!-- --> <!-- -->to<!-- --> <!-- -->support<!-- --> <!-- -->the<!-- --> <!-- -->coq<!-- --> <!-- -->language,<!-- --> <!-- -->I<!-- --> <!-- -->also<!-- --> <!-- -->loaded<!-- --> <!-- -->the<!-- --> <code>coq</code> <!-- -->layer.<!-- --> <!-- -->But<!-- --> <!-- -->if<!-- --> <!-- -->you<!-- --> <!-- -->open<!-- --> <!-- -->a<!-- --> <!-- -->coq<!-- --> <!-- -->file,<!-- --> <!-- -->you<!-- --> <!-- -->may<!-- --> <!-- -->be<!-- --> <!-- -->surprised<!-- --> <!-- -->to<!-- --> <!-- -->find<!-- --> <!-- -->that<!-- --> <!-- -->the<!-- --> <!-- -->coq<!-- --> <!-- -->source<!-- --> <!-- -->code<!-- --> <!-- -->does<!-- --> <!-- -->not<!-- --> <!-- -->have<!-- --> <!-- -->line<!-- --> <!-- -->numbers:</p><figure><div><img src="https://pic.superbed.cc/item/656efcb312f8d922c1008d4a.png"/></div></figure><p>According<!-- --> <!-- -->to<!-- --> <!-- -->normal<!-- --> <!-- -->intuition,<!-- --> <!-- -->setting<!-- --> <!-- -->to<!-- --> <code>t</code> <!-- -->should<!-- --> <!-- -->display<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->in<!-- --> <!-- -->all<!-- --> <!-- -->cases.<!-- --> <!-- -->So,<!-- --> <!-- -->why<!-- --> <!-- -->are<!-- --> <!-- -->there<!-- --> <!-- -->no<!-- --> <!-- -->line<!-- --> <!-- -->numbers?</p><h2 class="text-3xl" id="temporary-solution"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#temporary-solution">#</a>Temporary<!-- --> <!-- -->Solution</h2><p>Solving<!-- --> <!-- -->this<!-- --> <!-- -->problem<!-- --> <!-- -->is<!-- --> <!-- -->actually<!-- --> <!-- -->easier<!-- --> <!-- -->than<!-- --> <!-- -->figuring<!-- --> <!-- -->out<!-- --> <!-- -->the<!-- --> <!-- -->reason.</p><p>After<!-- --> <!-- -->a<!-- --> <!-- -->little<!-- --> <!-- -->search,<!-- --> <!-- -->I<!-- --> <!-- -->found<!-- --> <!-- -->that<!-- --> <code>spc t n</code> <sup><a href="#note-1" id="note-anchor-1">1</a></sup> <!-- -->can<!-- --> <!-- -->turn<!-- --> <!-- -->on<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->in<!-- --> <!-- -->the<!-- --> <!-- -->current<!-- --> <!-- -->buffer,<!-- --> <!-- -->which<!-- --> <!-- -->can<!-- --> <!-- -->indeed<!-- --> <!-- -->solve<!-- --> <!-- -->the<!-- --> <!-- -->problem.<!-- --> <!-- -->According<!-- --> <!-- -->to<!-- --> <!-- -->the<!-- --> <!-- -->Emacs<!-- --> <!-- -->wiki,<!-- --> <!-- -->this<!-- --> <!-- -->shortcut<!-- --> <!-- -->actually<!-- --> <!-- -->calls<!-- --> <!-- -->the<!-- --> <!-- -->line<!-- --> <!-- -->number<!-- --> <!-- -->command<!-- --> <code>display-line-numbers-mode</code> <!-- -->introduced<!-- --> <!-- -->after<!-- --> <!-- -->Emacs<!-- --> <!-- -->26.1<!-- --> <!-- -->version.</p><p>Emacs<!-- --> <!-- -->commands<!-- --> <!-- -->can<!-- --> <!-- -->be<!-- --> <!-- -->executed<!-- --> <!-- -->through<!-- --> <code>m-x</code>,<!-- --> <!-- -->or<!-- --> <code>spc spc</code>.<!-- --> <!-- -->In<!-- --> <!-- -->fact,<!-- --> <!-- -->a<!-- --> <!-- -->command<!-- --> <!-- -->is<!-- --> <!-- -->an<!-- --> <!-- -->Emacs<!-- --> <!-- -->Lisp<!-- --> <!-- -->function.<!-- --> <!-- -->According<!-- --> <!-- -->to<!-- --> <!-- -->the<!-- --> <a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Interactive-multiply_002dby_002dseven.html">documentation</a> <!-- -->of<!-- --> <!-- -->Programming<!-- --> <!-- -->Elisp,<!-- --> <!-- -->as<!-- --> <!-- -->long<!-- --> <!-- -->as<!-- --> <!-- -->there<!-- --> <!-- -->is<!-- --> <code>(interactive)</code> <!-- -->in<!-- --> <!-- -->the<!-- --> <!-- -->function<!-- --> <!-- -->definition<!-- --> <!-- -->of<!-- --> <!-- -->a<!-- --> <!-- -->function,<!-- --> <!-- -->it<!-- --> <!-- -->can<!-- --> <!-- -->be<!-- --> <!-- -->called<!-- --> <!-- -->as<!-- --> <!-- -->a<!-- --> <!-- -->command.</p><p>Clearly,<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->also<!-- --> <!-- -->sets<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->through<!-- --> <!-- -->this<!-- --> <!-- -->function.<!-- --> <!-- -->Although<!-- --> <!-- -->I<!-- --> <!-- -->donâ€™t<!-- --> <!-- -->know<!-- --> <!-- -->why<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->didnâ€™t<!-- --> <!-- -->turn<!-- --> <!-- -->on<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->for<!-- --> <!-- -->my<!-- --> <code>.v</code> <!-- -->files,<!-- --> <!-- -->we<!-- --> <!-- -->can<!-- --> <!-- -->turn<!-- --> <!-- -->them<!-- --> <!-- -->on<!-- --> <!-- -->ourselves.</p><p>The<!-- --> <code>coq</code> <!-- -->layer<!-- --> <!-- -->actually<!-- --> <!-- -->uses<!-- --> <code>coq-mode</code>.<!-- --> <code>coq-mode</code> <!-- -->is<!-- --> <!-- -->a<!-- --> <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Major-Modes.html">Major<!-- --> <!-- -->Mode</a> <!-- -->of<!-- --> <!-- -->Emacs,<!-- --> <!-- -->which<!-- --> <!-- -->provides<!-- --> <!-- -->support<!-- --> <!-- -->for<!-- --> <!-- -->the<!-- --> <!-- -->coq<!-- --> <!-- -->language<!-- --> <!-- -->and<!-- --> <!-- -->defines<!-- --> <!-- -->a<!-- --> <!-- -->bunch<!-- --> <!-- -->of<!-- --> <!-- -->shortcuts.</p><p>Emacs<!-- --> <!-- -->supports<!-- --> <!-- -->a<!-- --> <!-- -->mechanism<!-- --> <!-- -->called<!-- --> <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html">Hooks</a>,<!-- --> <!-- -->which<!-- --> <!-- -->allows<!-- --> <!-- -->us<!-- --> <!-- -->to<!-- --> <!-- -->perform<!-- --> <!-- -->a<!-- --> <!-- -->series<!-- --> <!-- -->of<!-- --> <!-- -->operations<!-- --> <!-- -->when<!-- --> <!-- -->a<!-- --> <!-- -->mode<!-- --> <!-- -->is<!-- --> <!-- -->loaded.<!-- --> <!-- -->Since<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->wonâ€™t<!-- --> <!-- -->turn<!-- --> <!-- -->on<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->for<!-- --> <code>coq-mode</code>,<!-- --> <!-- -->we<!-- --> <!-- -->manually<!-- --> <!-- -->execute<!-- --> <code>display-line-numbers-mode</code> <!-- -->through<!-- --> <!-- -->this<!-- --> <!-- -->mechanism.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(286, 60%, 67%)">defun</span><span class="token defun"> </span><span class="token defun" style="color:hsl(207, 82%, 66%)">dotspacemacs/user-config</span><span class="token defun"> </span><span class="token defun" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;Configuration for user code:
</span><span class="token" style="color:hsl(95, 38%, 62%)"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span>This function is called at the very end of Spacemacs startup, after layer
</span><span class="token" style="color:hsl(95, 38%, 62%)"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span>configuration.
</span><span class="token" style="color:hsl(95, 38%, 62%)"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span>Put your configuration code here, except for variables that should be set
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span class="token" style="color:hsl(95, 38%, 62%)">before packages are loaded.&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">add-hook</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;coq-mode-hook</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token lambda" style="color:hsl(286, 60%, 67%)">lambda</span><span class="token lambda"> </span><span class="token lambda" style="color:hsl(220, 14%, 71%)">(</span><span class="token lambda" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">display-line-numbers-mode</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>Here,<!-- --> <code>dotspacemacs/user-config</code> <!-- -->is<!-- --> <!-- -->part<!-- --> <!-- -->of<!-- --> <!-- -->the<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->configuration<!-- --> <!-- -->file,<!-- --> <!-- -->where<!-- --> <!-- -->you<!-- --> <!-- -->can<!-- --> <!-- -->perform<!-- --> <!-- -->some<!-- --> <!-- -->custom<!-- --> <!-- -->operations.</p><p>This<!-- --> <!-- -->of<!-- --> <!-- -->course<!-- --> <!-- -->solves<!-- --> <!-- -->the<!-- --> <!-- -->problem.<!-- --> <!-- -->In<!-- --> <!-- -->fact,<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->also<!-- --> <!-- -->mentions<!-- --> <!-- -->an<!-- --> <!-- -->option<!-- --> <code>:enabled-for-modes</code> <!-- -->in<!-- --> <!-- -->the<!-- --> <!-- -->documentation.<!-- --> <!-- -->Adding<!-- --> <code>coq-mode</code> <!-- -->to<!-- --> <!-- -->this<!-- --> <!-- -->option<!-- --> <!-- -->can<!-- --> <!-- -->directly<!-- --> <!-- -->solve<!-- --> <!-- -->the<!-- --> <!-- -->problem.<!-- --> <!-- -->However,<!-- --> <!-- -->I<!-- --> <!-- -->didnâ€™t<!-- --> <!-- -->discover<!-- --> <!-- -->this<!-- --> <!-- -->option<!-- --> <!-- -->until<!-- --> <!-- -->I<!-- --> <!-- -->figured<!-- --> <!-- -->out<!-- --> <!-- -->the<!-- --> <!-- -->source<!-- --> <!-- -->of<!-- --> <!-- -->the<!-- --> <!-- -->problem.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">setq-default</span><span> dotspacemacs-line-numbers
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">&#x27;(</span><span class="token lisp-property" style="color:hsl(355, 65%, 65%)">:enabled-for-modes</span><span> coq-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><h2 class="text-3xl" id="why"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#why">#</a>Why</h2><p>The<!-- --> <!-- -->first<!-- --> <!-- -->thing<!-- --> <!-- -->I<!-- --> <!-- -->noticed<!-- --> <!-- -->was<!-- --> <!-- -->the<!-- --> <!-- -->comment<!-- --> <!-- -->for<!-- --> <code>dotspacemacs-line-numbers</code>:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; Control line numbers activation.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; If set to `t&#x27;, `relative&#x27; or `visual&#x27; then line numbers are enabled in all</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; `prog-mode&#x27; and `text-mode&#x27; derivatives. If set to `relative&#x27;, line</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; numbers are relative. If set to `visual&#x27;, line numbers are also relative,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; but only visual lines are counted. For example, folded lines will not be</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; counted and wrapped lines are counted as multiple lines.</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; This variable can also be set to a property list for finer control:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; (default nil)</span></code></pre><p>This<!-- --> <!-- -->comment<!-- --> <!-- -->mentions<!-- --> <!-- -->that<!-- --> <!-- -->if<!-- --> <!-- -->this<!-- --> <!-- -->variable<!-- --> <!-- -->is<!-- --> <!-- -->set<!-- --> <!-- -->to<!-- --> <code>t</code>,<!-- --> <!-- -->it<!-- --> <!-- -->will<!-- --> <!-- -->enable<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->by<!-- --> <!-- -->default<!-- --> <!-- -->in<!-- --> <code>prog-mode</code> <!-- -->and<!-- --> <code>text-mode</code>.<!-- --> <!-- -->These<!-- --> <!-- -->two<!-- --> <!-- -->modes<!-- --> <!-- -->are<!-- --> <!-- -->known<!-- --> <!-- -->as<!-- --> <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Basic-Major-Modes.html">Basic<!-- --> <!-- -->Major<!-- --> <!-- -->Modes</a>.<!-- --> <!-- -->A<!-- --> <!-- -->natural<!-- --> <!-- -->guess<!-- --> <!-- -->is<!-- --> <!-- -->that<!-- --> <code>coq-mode</code> <!-- -->is<!-- --> <!-- -->not<!-- --> <!-- -->one<!-- --> <!-- -->of<!-- --> <!-- -->them.</p><p>Open<!-- --> <!-- -->a<!-- --> <!-- -->coq<!-- --> <!-- -->file,<!-- --> <!-- -->execute<!-- --> <code>m-x describe-mode</code>,<!-- --> <!-- -->and<!-- --> <!-- -->you<!-- --> <!-- -->will<!-- --> <!-- -->see:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span>Coq mode defined in â€˜coq-mode.elâ€™:
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span>Major mode for Coq scripts.</code></pre><p>Enter<!-- --> <!-- -->the<!-- --> <!-- -->source<!-- --> <!-- -->code<!-- --> <!-- -->of<!-- --> <code>coq-mode.el</code> <!-- -->to<!-- --> <!-- -->take<!-- --> <!-- -->a<!-- --> <!-- -->look,<!-- --> <!-- -->the<!-- --> <!-- -->mystery<!-- --> <!-- -->lies<!-- --> <!-- -->in<!-- --> <!-- -->line<!-- --> <!-- -->182:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(286, 60%, 67%)">defun</span><span class="token defun"> </span><span class="token defun" style="color:hsl(207, 82%, 66%)">coq--parent-mode</span><span class="token defun"> </span><span class="token defun" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> coq-use-pg </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">proof-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">prog-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token heading" style="color:hsl(220, 10%, 40%);font-style:italic">;;;###autoload</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">define-derived-mode</span><span> coq-mode coq--parent-mode </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;Coq&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span>  &quot;Major mode for Coq scripts.</code></pre><p>This<!-- --> <code>coq--parent-mode</code> <!-- -->is<!-- --> <!-- -->obviously<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode<!-- --> <!-- -->of<!-- --> <code>coq-mode</code> <!-- -->(parent<!-- --> <!-- -->mode),<!-- --> <!-- -->Emascâ€™s<!-- --> <!-- -->mode<!-- --> <!-- -->also<!-- --> <!-- -->has<!-- --> <!-- -->an<!-- --> <!-- -->inheritance<!-- --> <!-- -->tree,<!-- --> <!-- -->a<!-- --> <!-- -->mode<!-- --> <!-- -->inherits<!-- --> <!-- -->another<!-- --> <!-- -->parent<!-- --> <!-- -->mode,<!-- --> <!-- -->the<!-- --> <!-- -->root<!-- --> <!-- -->of<!-- --> <!-- -->this<!-- --> <!-- -->tree<!-- --> <!-- -->is<!-- --> <!-- -->uncertain,<!-- --> <!-- -->there<!-- --> <!-- -->are<!-- --> <!-- -->several<!-- --> <!-- -->situations:</p><ul><li>Itself</li><li>Fundamental<!-- --> <!-- -->Mode</li><li>Basic<!-- --> <!-- -->Major<!-- --> <!-- -->Mode</li></ul><p>The<!-- --> <!-- -->value<!-- --> <!-- -->of<!-- --> <code>coq-use-pg</code> <!-- -->in<!-- --> <!-- -->my<!-- --> <!-- -->environment<!-- --> <!-- -->is<!-- --> <code>t</code>,<!-- --> <!-- -->and<!-- --> <!-- -->its<!-- --> <!-- -->parent<!-- --> <!-- -->mode<!-- --> <!-- -->is<!-- --> <code>proof-mode</code>.<!-- --> <!-- -->What<!-- --> <!-- -->is<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode<!-- --> <!-- -->of<!-- --> <code>proof-mode</code>?</p><p>A<!-- --> <a href="https://emacs.stackexchange.com/questions/58073/how-to-find-inheritance-of-modes">question</a> <!-- -->on<!-- --> <!-- -->StackOverflow<!-- --> <!-- -->provides<!-- --> <!-- -->the<!-- --> <!-- -->relevant<!-- --> <!-- -->code:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(286, 60%, 67%)">defun</span><span class="token defun"> </span><span class="token defun" style="color:hsl(207, 82%, 66%)">derived-modes</span><span class="token defun"> </span><span class="token defun" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun arguments argument" style="color:hsl(207, 82%, 66%)">mode</span><span class="token defun" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;Return a list of the ancestor modes that </span><span class="token argument" style="color:hsl(95, 38%, 62%)">MODE</span><span class="token" style="color:hsl(95, 38%, 62%)"> is derived from.&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">let</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">modes</span><span>   </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>        </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">parent</span><span>  </span><span class="token" style="color:hsl(29, 54%, 61%)">nil</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">while</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">setq</span><span> parent </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">get</span><span> mode </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;derived-mode-parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span>      </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">push</span><span> parent modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>      </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">setq</span><span> mode parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">setq</span><span> modes  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">nreverse</span><span> modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>With<!-- --> <!-- -->this<!-- --> <!-- -->function,<!-- --> <!-- -->you<!-- --> <!-- -->can<!-- --> <!-- -->indeed<!-- --> <!-- -->get<!-- --> <!-- -->the<!-- --> <!-- -->inheritance<!-- --> <!-- -->path<!-- --> <!-- -->of<!-- --> <!-- -->some<!-- --> <q>normal</q> <!-- -->modes,<!-- --> <!-- -->such<!-- --> <!-- -->as<!-- --> <!-- -->the<!-- --> <code>proof-mode</code> <!-- -->we<!-- --> <!-- -->just<!-- --> <!-- -->mentioned:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span>ELISP&gt; </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">derived-modes</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;proof-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">prog-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>Yes,<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode<!-- --> <!-- -->of<!-- --> <code>proof-mode</code> <!-- -->is<!-- --> <code>prog-mode</code>.<!-- --> <!-- -->If<!-- --> <!-- -->you<!-- --> <!-- -->still<!-- --> <!-- -->remember<!-- --> <!-- -->the<!-- --> <!-- -->document<!-- --> <!-- -->just<!-- --> <!-- -->now,<!-- --> <code>prog-mode</code> <!-- -->should<!-- --> <!-- -->also<!-- --> <!-- -->display<!-- --> <!-- -->line<!-- --> <!-- -->numbers<!-- --> <!-- -->when<!-- --> <code>dotspacemacs-line-numbers</code> <!-- -->is<!-- --> <!-- -->set<!-- --> <!-- -->to<!-- --> <code>t</code>.</p><p>So,<!-- --> <!-- -->what<!-- --> <!-- -->went<!-- --> <!-- -->wrong?<!-- --> <!-- -->Letâ€™s<!-- --> <!-- -->input<!-- --> <code>&#x27;coq-mode</code> <!-- -->into<!-- --> <!-- -->this<!-- --> <!-- -->function:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span>ELISP&gt; </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">derived-modes</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;coq-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">coq--parent-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>Its<!-- --> <!-- -->output<!-- --> <!-- -->is<!-- --> <code>(coq--parent-mode)</code>,<!-- --> <!-- -->which<!-- --> <!-- -->is<!-- --> <!-- -->just<!-- --> <!-- -->the<!-- --> <!-- -->symbol<!-- --> <!-- -->of<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode,<!-- --> <!-- -->not<!-- --> <!-- -->the<!-- --> <!-- -->evaluated<!-- --> <!-- -->parent<!-- --> <!-- -->mode.<!-- --> <!-- -->It<!-- --> <!-- -->can<!-- --> <!-- -->be<!-- --> <!-- -->seen<!-- --> <!-- -->that<!-- --> <!-- -->the<!-- --> <!-- -->expression<!-- --> <code>(get &#x27;coq-mode &#x27;derived-parent-mode)</code> <!-- -->can<!-- --> <!-- -->only<!-- --> <!-- -->get<!-- --> <!-- -->the<!-- --> <!-- -->symbol<!-- --> <!-- -->in<!-- --> <!-- -->syntax,<!-- --> <!-- -->not<!-- --> <!-- -->its<!-- --> <!-- -->real<!-- --> <!-- -->parent<!-- --> <!-- -->mode.<!-- --> <!-- -->Checking<!-- --> <!-- -->the<!-- --> <!-- -->source<!-- --> <!-- -->code<!-- --> <!-- -->of<!-- --> <code>define-derived-mode</code>,<!-- --> <!-- -->you<!-- --> <!-- -->can<!-- --> <!-- -->find<!-- --> <!-- -->that<!-- --> <!-- -->what<!-- --> <code>(get mode &#x27;derived-mode-parent)</code> <!-- -->gets<!-- --> <!-- -->is<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode<!-- --> <!-- -->set<!-- --> <!-- -->by<!-- --> <!-- -->this<!-- --> <!-- -->sentence:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">put</span><span> &#x27;</span><span class="token splice" style="color:hsl(207, 82%, 66%)">,child</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;derived-mode-parent</span><span> &#x27;</span><span class="token splice" style="color:hsl(207, 82%, 66%)">,parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>So,<!-- --> <!-- -->is<!-- --> <!-- -->this<!-- --> <!-- -->how<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->gets<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode?<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->checks<!-- --> <!-- -->whether<!-- --> <!-- -->line<!-- --> <!-- -->number<!-- --> <!-- -->display<!-- --> <!-- -->is<!-- --> <!-- -->enabled<!-- --> <!-- -->in<!-- --> <!-- -->the<!-- --> <!-- -->current<!-- --> <!-- -->mode<!-- --> <!-- -->in<!-- --> <!-- -->the<!-- --> <code>spacemacs//linum-enabled-for-current-major-mode</code> <!-- -->function<!-- --> <!-- -->in<!-- --> <code>spacemacs/layers/+spacemacs/spacemacs-defaults/funcs.el</code>:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(286, 60%, 67%)">defun</span><span class="token defun"> </span><span class="token defun" style="color:hsl(207, 82%, 66%)">spacemacs//linum-enabled-for-current-major-mode</span><span class="token defun"> </span><span class="token defun" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;Return non-nil if line number is enabled for current major-mode.&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">let*</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">disabled-for-modes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>          </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">spacemacs/mplist-get-values</span><span> dotspacemacs-line-numbers
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>                                       </span><span class="token lisp-property" style="color:hsl(355, 65%, 65%)">:disabled-for-modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span>         </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">user-enabled-for-modes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>          </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">spacemacs/mplist-get-values</span><span> dotspacemacs-line-numbers
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>                                       </span><span class="token lisp-property" style="color:hsl(355, 65%, 65%)">:enabled-for-modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>         </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; default `enabled-for-modes&#x27; to &#x27;(prog-mode text-mode), because it is</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span><span>         </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; a more sensible default than enabling in all buffers - including</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span>         </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; Magit buffers, terminal buffers, etc. But don&#x27;t include prog-mode or</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span><span>         </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; text-mode if they&#x27;re explicitly disabled by user</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span><span>         </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">enabled-for-modes</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">or</span><span> user-enabled-for-modes
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span><span>                                </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">seq-difference</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">&#x27;(</span><span class="token car">prog-mode</span><span> text-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span>                                                disabled-for-modes
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">16</span><span>                                                </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">#&#x27;eq</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">17</span><span>         </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">enabled-for-parent</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">or</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">equal</span><span> enabled-for-modes </span><span class="token" style="color:hsl(220, 14%, 71%)">&#x27;(</span><span class="token car">all</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;all</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">18</span><span>                                 </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">apply</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">#&#x27;derived-mode-p</span><span> enabled-for-modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">19</span><span>         </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">disabled-for-parent</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">apply</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">#&#x27;derived-mode-p</span><span> disabled-for-modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">20</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">or</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">21</span><span>     </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; special case &#x27;all: enable for any mode that isn&#x27;t specifically disabled</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">22</span><span>     </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">eq</span><span> enabled-for-parent </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;all</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> disabled-for-parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">23</span><span>     </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; current mode or a parent is in :enabled-for-modes, and there isn&#x27;t a</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">24</span><span>     </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; more specific parent (or the mode itself) in :disabled-for-modes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">25</span><span>     </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> enabled-for-parent
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">26</span><span>          </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">or</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> disabled-for-parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">27</span><span>              </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; handles the case where current major-mode has a parent both in</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">28</span><span>              </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; :enabled-for-modes and in :disabled-for-modes. Return non-nil</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">29</span><span>              </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; if enabled-for-parent is the more specific parent (IOW derives</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">30</span><span>              </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; from disabled-for-parent)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">31</span><span>              </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">spacemacs/derived-mode-p</span><span> enabled-for-parent disabled-for-parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">32</span><span>     </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">;; current mode (or parent) not explicitly disabled</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">33</span><span>     </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">null</span><span> user-enabled-for-modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">34</span><span>          enabled-for-parent            </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">; mode is one of default allowed modes</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">35</span>          disabled-for-modes
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">36</span><span>          </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> disabled-for-parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>As<!-- --> <!-- -->you<!-- --> <!-- -->can<!-- --> <!-- -->see,<!-- --> <!-- -->it<!-- --> <!-- -->asks<!-- --> <!-- -->the<!-- --> <!-- -->current<!-- --> <!-- -->bufferâ€™s<!-- --> <!-- -->major<!-- --> <!-- -->mode<!-- --> <!-- -->if<!-- --> <!-- -->it<!-- --> <!-- -->is<!-- --> <!-- -->a<!-- --> <!-- -->child<!-- --> <!-- -->mode<!-- --> <!-- -->of<!-- --> <!-- -->the<!-- --> <!-- -->preset<!-- --> <code>enabled-for-modes</code> <!-- -->through<!-- --> <!-- -->the<!-- --> <code>derived-mode-p</code> <!-- -->function.<!-- --> <code>dervied-mode-p</code> <!-- -->is<!-- --> <!-- -->a<!-- --> <!-- -->function<!-- --> <!-- -->provided<!-- --> <!-- -->by<!-- --> <!-- -->Emacs,<!-- --> <!-- -->and<!-- --> <!-- -->the<!-- --> <a href="https://doc.endlessparentheses.com/Fun/derived-mode-p.html">documentation</a> <!-- -->claims<!-- --> <!-- -->that<!-- --> <!-- -->if<!-- --> <!-- -->the<!-- --> <!-- -->current<!-- --> <!-- -->bufferâ€™s<!-- --> <!-- -->main<!-- --> <!-- -->mode<!-- --> <!-- -->is<!-- --> <!-- -->a<!-- --> <!-- -->child<!-- --> <!-- -->mode<!-- --> <!-- -->of<!-- --> <code>modes</code>,<!-- --> <!-- -->then<!-- --> <code>(derived-mode-p modes)</code> <!-- -->will<!-- --> <!-- -->return<!-- --> <!-- -->a<!-- --> <!-- -->non-<code>nil</code> <!-- -->value.</p><p>Upon<!-- --> <!-- -->further<!-- --> <!-- -->inspection<!-- --> <!-- -->of<!-- --> <!-- -->the<!-- --> <!-- -->source<!-- --> <!-- -->code<!-- --> <!-- -->of<!-- --> <code>derived-mode-p</code>,<!-- --> <!-- -->we<!-- --> <!-- -->finally<!-- --> <!-- -->found<!-- --> <!-- -->the<!-- --> <!-- -->root<!-- --> <!-- -->of<!-- --> <!-- -->the<!-- --> <!-- -->problem.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(286, 60%, 67%)">defun</span><span class="token defun"> </span><span class="token defun" style="color:hsl(207, 82%, 66%)">provided-mode-derived-p</span><span class="token defun"> </span><span class="token defun" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun arguments argument" style="color:hsl(207, 82%, 66%)">mode</span><span class="token defun arguments"> </span><span class="token defun arguments rest-vars lisp-marker">&amp;rest</span><span class="token defun arguments rest-vars"> </span><span class="token defun arguments rest-vars argument">modes</span><span class="token defun" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;Non-nil if </span><span class="token argument" style="color:hsl(95, 38%, 62%)">MODE</span><span class="token" style="color:hsl(95, 38%, 62%)"> is derived from one of </span><span class="token argument" style="color:hsl(95, 38%, 62%)">MODES</span><span class="token" style="color:hsl(95, 38%, 62%)"> or their aliases.
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span class="token" style="color:hsl(95, 38%, 62%)">Uses the </span><span class="token" style="color:hsl(355, 65%, 65%)">`derived-mode-parent&#x27;</span><span class="token" style="color:hsl(95, 38%, 62%)"> property of the symbol to trace backwards.
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span class="token" style="color:hsl(95, 38%, 62%)">If you just want to check </span><span class="token" style="color:hsl(355, 65%, 65%)">`major-mode&#x27;</span><span class="token" style="color:hsl(95, 38%, 62%)">, use </span><span class="token" style="color:hsl(355, 65%, 65%)">`derived-mode-p&#x27;</span><span class="token" style="color:hsl(95, 38%, 62%)">.&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">while</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span>      </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>       </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">not</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">memq</span><span> mode modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>       </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">let*</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">parent</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">get</span><span> mode </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;derived-mode-parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>              </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">parentfn</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">symbol-function</span><span> parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span><span>         </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">setq</span><span> mode </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> parentfn </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">symbolp</span><span> parentfn</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> parentfn parent</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span>  mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun" style="color:hsl(286, 60%, 67%)">defun</span><span class="token defun"> </span><span class="token defun" style="color:hsl(207, 82%, 66%)">derived-mode-p</span><span class="token defun"> </span><span class="token defun" style="color:hsl(220, 14%, 71%)">(</span><span class="token defun arguments rest-vars lisp-marker">&amp;rest</span><span class="token defun arguments rest-vars"> </span><span class="token defun arguments rest-vars argument">modes</span><span class="token defun" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span><span>  </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;Non-nil if the current major mode is derived from one of </span><span class="token argument" style="color:hsl(95, 38%, 62%)">MODES</span><span class="token" style="color:hsl(95, 38%, 62%)">.
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span><span class="token" style="color:hsl(95, 38%, 62%)">Uses the </span><span class="token" style="color:hsl(355, 65%, 65%)">`derived-mode-parent&#x27;</span><span class="token" style="color:hsl(95, 38%, 62%)"> property of the symbol to trace backwards.&quot;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">16</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">apply</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">#&#x27;provided-mode-derived-p</span><span> major-mode modes</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p><code>dervied-mode-p</code> <!-- -->also<!-- --> <!-- -->gets<!-- --> <!-- -->the<!-- --> <!-- -->parent<!-- --> <!-- -->mode<!-- --> <!-- -->of<!-- --> <!-- -->a<!-- --> <!-- -->certain<!-- --> <!-- -->mode<!-- --> <!-- -->through<!-- --> <code>(get mode &#x27;derived-mode-parent)</code>,<!-- --> <!-- -->but<!-- --> <!-- -->for<!-- --> <code>coq-mode</code>,<!-- --> <!-- -->it<!-- --> <!-- -->will<!-- --> <!-- -->get<!-- --> <code>coq--parent-mode</code>,<!-- --> <!-- -->and<!-- --> <!-- -->the<!-- --> <!-- -->inheritance<!-- --> <!-- -->chain<!-- --> <!-- -->breaks<!-- --> <!-- -->here.</p><p>The<!-- --> <!-- -->final<!-- --> <!-- -->definition<!-- --> <!-- -->of<!-- --> <!-- -->mode<!-- --> <!-- -->in<!-- --> <!-- -->Emacs<!-- --> <!-- -->is<!-- --> <!-- -->indeed<!-- --> <!-- -->a<!-- --> <!-- -->function.<!-- --> <!-- -->However,<!-- --> <!-- -->if<!-- --> <code>&#x27;parent</code> <!-- -->cannot<!-- --> <!-- -->evaluate<!-- --> <!-- -->the<!-- --> <!-- -->correct<!-- --> <!-- -->parent<!-- --> <!-- -->mode,<!-- --> <!-- -->Emacsâ€™<!-- --> <!-- -->preset<!-- --> <!-- -->function<!-- --> <!-- -->for<!-- --> <!-- -->mode<!-- --> <!-- -->will<!-- --> <!-- -->not<!-- --> <!-- -->get<!-- --> <!-- -->the<!-- --> <!-- -->expected<!-- --> <!-- -->result.<!-- --> <!-- -->Obviously,<!-- --> <code>coq-mode</code> <!-- -->should<!-- --> <!-- -->not<!-- --> <!-- -->define<!-- --> <code>coq--parent-mode</code> <!-- -->in<!-- --> <!-- -->this<!-- --> <!-- -->way.<!-- --> <!-- -->So,<!-- --> <!-- -->how<!-- --> <!-- -->should<!-- --> <code>coq--parent-mode</code> <!-- -->be<!-- --> <!-- -->defined?</p><h2 class="text-3xl" id="final-solution"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#final-solution">#</a>Final<!-- --> <!-- -->Solution</h2><p>The<!-- --> <!-- -->global<!-- --> <!-- -->variables<!-- --> <!-- -->and<!-- --> <!-- -->global<!-- --> <!-- -->functions<!-- --> <!-- -->of<!-- --> <!-- -->Emacs<!-- --> <!-- -->Lisp<!-- --> <!-- -->are<!-- --> <!-- -->different,<!-- --> <!-- -->which<!-- --> <!-- -->is<!-- --> <!-- -->very<!-- --> <!-- -->different<!-- --> <!-- -->from<!-- --> <!-- -->Scheme.<!-- --> <!-- -->If<!-- --> <!-- -->you<!-- --> <!-- -->directly<!-- --> <!-- -->define<!-- --> <code>coq--parent-mode</code> <!-- -->as<!-- --> <!-- -->a<!-- --> <!-- -->variable,<!-- --> <!-- -->it<!-- --> <!-- -->will<!-- --> <!-- -->make<!-- --> <code>coq-mode</code> <!-- -->unable<!-- --> <!-- -->to<!-- --> <!-- -->load.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token defvar" style="color:hsl(286, 60%, 67%)">defvar</span><span class="token defvar"> </span><span class="token defvar" style="color:hsl(207, 82%, 66%)">coq--parent-mode</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> coq-use-pg </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;proof-mode</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;prog-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>Fortunately,<!-- --> <!-- -->Emacs<!-- --> <!-- -->Lisp<!-- --> <!-- -->provides<!-- --> <!-- -->a<!-- --> <!-- -->function<!-- --> <!-- -->called<!-- --> <code>defalias</code>,<!-- --> <!-- -->which<!-- --> <!-- -->can<!-- --> <!-- -->define<!-- --> <code>coq--parent-mode</code> <!-- -->as<!-- --> <!-- -->an<!-- --> <!-- -->alias.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-elisp" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token car">defalias</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;coq--parent-mode</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> coq-use-pg </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;proof-mode</span><span> </span><span class="token quoted-symbol" style="color:hsl(355, 65%, 65%)">&#x27;prog-mode</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p>The<!-- --> <!-- -->above<!-- --> <!-- -->modification<!-- --> <!-- -->is<!-- --> <!-- -->enough<!-- --> <!-- -->to<!-- --> <!-- -->make<!-- --> <!-- -->Spacemacs<!-- --> <!-- -->automatically<!-- --> <!-- -->detect<!-- --> <!-- -->that<!-- --> <code>coq-mode</code> <!-- -->is<!-- --> <!-- -->derived<!-- --> <!-- -->from<!-- --> <code>prog-mode</code>,<!-- --> <!-- -->thus<!-- --> <!-- -->turning<!-- --> <!-- -->on<!-- --> <!-- -->line<!-- --> <!-- -->number<!-- --> <!-- -->display.<!-- --> <!-- -->I<!-- --> <!-- -->have<!-- --> <!-- -->submitted<!-- --> <!-- -->a<!-- --> <a href="https://github.com/ProofGeneral/PG/pull/717">PR</a> <!-- -->and<!-- --> <!-- -->merged<!-- --> <!-- -->it<!-- --> <!-- -->into<!-- --> <!-- -->the<!-- --> <!-- -->main<!-- --> <!-- -->branch.</p><div class="notes"></div></article></div></div></div></div><script src="/_next/static/chunks/webpack-f70da49b2a689e16.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/c6bd041446e6519a.css\",\"style\"]\n2:HL[\"/_next/static/css/ad2762ca96cee671.css\",\"style\"]\n3:HL[\"/_next/static/css/d0ab39c2387d2115.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[89562,[],\"\"]\n7:I[78703,[],\"\"]\na:I[53751,[],\"\"]\nb:I[59576,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"Providers\"]\ne:I[51395,[],\"\"]\n8:[\"locale\",\"en\",\"d\"]\n9:[\"slug\",\"emacs-line-number\",\"d\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[null,[\"$\",\"$L4\",null,{\"buildId\":\"qtmez-VgEwHMuaaGGpdGk\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/en/posts/emacs-line-number\",\"initialTree\":[\"\",{\"children\":[[\"locale\",\"en\",\"d\"],{\"children\":[\"posts\",{\"children\":[[\"slug\",\"emacs-line-number\",\"d\"],{\"children\":[\"__PAGE__?{\\\"locale\\\":\\\"en\\\",\\\"slug\\\":\\\"emacs-line-number\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"locale\",\"en\",\"d\"],{\"children\":[\"posts\",{\"children\":[[\"slug\",\"emacs-line-number\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\"],null],null]},[[\"$\",\"div\",null,{\"className\":\" relative w-full py-12 shadow-xl shadow-slate-700/20 ring-1 ring-gray-900/5 dark:shadow-slate-100/20 dark:ring-gray-100/5 lg:mx-auto lg:max-w-4xl lg:pt-16 lg:pb-28\",\"children\":[\"$\",\"div\",null,{\"className\":\"prose prose-natural dark:prose-invert mx-auto max-w-full px-8 sm:px-16 relative\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\",\"posts\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d0ab39c2387d2115.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}]}]}],null],null]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"text-foreground bg-background min-h-screen\",\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$Lc\",[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]}]}]}],null],null]},[[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c6bd041446e6519a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ad2762ca96cee671.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"Navbar\"]\n11:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"NavbarBrand\"]\n13:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"NavbarItem\"]\n16:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"NavbarContent\"]\n17:I[81946,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"default\"]\n18:I[48125,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"default\"]\nc:[\"$\",\"$L10\",null,{\"shouldHideOnScroll\":true,\"children\":[[\"$\",\"$L11\",null,{\"className\":\"flex flex-row gap-4\",\"children\":[[\"$\",\"p\",null,{\"className\":\"font-bold text-inherit\",\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{\"children\":\"$L14\"}],[\"$\",\"$L13\",null,{\"children\":\"$L15\"}]]}],[\"$\",\"$L16\",null,{\"justify\":\"end\",\"className\":\"gap-1\",\"children\":[[\"$\",\"$L13\",null,{\"children\":[\"$\",\"$L17\",null,{}]}],["])</script><script>self.__next_f.push([1,"\"$\",\"$L13\",null,{\"children\":[\"$\",\"$L18\",null,{}]}]]}]]}]\nd:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Aya's Blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A site powered by next.js and pandoc\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}]]\n5:null\n"])</script><script>self.__next_f.push([1,"19:I[9678,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-a565b40c48425316.js\"],\"default\"]\n12:[\"$\",\"$L19\",null,{\"locale\":\"en\",\"localePrefix\":\"always\",\"href\":\"/\",\"aria-label\":\"Home\",\"children\":\"Home\"}]\n14:[\"$\",\"$L19\",null,{\"locale\":\"en\",\"localePrefix\":\"always\",\"href\":\"/blog/\",\"className\":\"font-bold\",\"aria-label\":\"Blog\",\"children\":\"Blog\"}]\n15:[\"$\",\"$L19\",null,{\"locale\":\"en\",\"localePrefix\":\"always\",\"href\":\"/favorites/\",\"className\":\"font-bold\",\"aria-label\":\"Favorites\",\"children\":\"Favorites\"}]\n"])</script><script>self.__next_f.push([1,"1a:\"$Sreact.fragment\"\n1b:I[75164,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"861\",\"static/chunks/861-2893a7c032654c11.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-adf657eca4f78e61.js\"],\"default\"]\n1c:I[37006,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"861\",\"static/chunks/861-2893a7c032654c11.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-adf657eca4f78e61.js\"],\"default\"]\n1d:I[65469,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"861\",\"static/chunks/861-2893a7c032654c11.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-adf657eca4f78e61.js\"],\"\"]\n1e:I[39926,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"861\",\"static/chunks/861-2893a7c032654c11.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-adf657eca4f78e61.js\"],\"default\"]\n20:I[27377,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"861\",\"static/chunks/861-2893a7c032654c11.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-adf657eca4f78e61.js\"],\"default\"]\n1f:T899,"])</script><script>self.__next_f.push([1,"(defun spacemacs//linum-enabled-for-current-major-mode ()\n  \"Return non-nil if line number is enabled for current major-mode.\"\n  (let* ((disabled-for-modes\n          (spacemacs/mplist-get-values dotspacemacs-line-numbers\n                                       :disabled-for-modes))\n         (user-enabled-for-modes\n          (spacemacs/mplist-get-values dotspacemacs-line-numbers\n                                       :enabled-for-modes))\n         ;; default `enabled-for-modes' to '(prog-mode text-mode), because it is\n         ;; a more sensible default than enabling in all buffers - including\n         ;; Magit buffers, terminal buffers, etc. But don't include prog-mode or\n         ;; text-mode if they're explicitly disabled by user\n         (enabled-for-modes (or user-enabled-for-modes\n                                (seq-difference '(prog-mode text-mode)\n                                                disabled-for-modes\n                                                #'eq)))\n         (enabled-for-parent (or (and (equal enabled-for-modes '(all)) 'all)\n                                 (apply #'derived-mode-p enabled-for-modes)))\n         (disabled-for-parent (apply #'derived-mode-p disabled-for-modes)))\n    (or\n     ;; special case 'all: enable for any mode that isn't specifically disabled\n     (and (eq enabled-for-parent 'all) (not disabled-for-parent))\n     ;; current mode or a parent is in :enabled-for-modes, and there isn't a\n     ;; more specific parent (or the mode itself) in :disabled-for-modes\n     (and enabled-for-parent\n          (or (not disabled-for-parent)\n              ;; handles the case where current major-mode has a parent both in\n              ;; :enabled-for-modes and in :disabled-for-modes. Return non-nil\n              ;; if enabled-for-parent is the more specific parent (IOW derives\n              ;; from disabled-for-parent)\n              (spacemacs/derived-mode-p enabled-for-parent disabled-for-parent)))\n     ;; current mode (or parent) not explicitly disabled\n     (and (null user-enabled-for-modes)\n          enabled-for-parent            ; mode is one of default allowed modes\n          disabled-for-modes\n          (not disabled-for-parent)))))"])</script><script>self.__next_f.push([1,"6:[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold mb-2\",\"children\":\"Enabling Line Number Display in coq-mode\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-500 mb-5\",\"children\":\"12/4/2023\"}],[\"$\",\"$1a\",\"0\",{\"children\":[[\"$\",\"$L1b\",null,{\"children\":[[\"$\",\"ul\",\"0\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#what-is-the-problem\",\"id\":\"toc-what-is-the-problem\",\"children\":[\"What\",\" \",\"is\",\" \",\"the\",\" \",\"problem\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#temporary-solution\",\"id\":\"toc-temporary-solution\",\"children\":[\"Temporary\",\" \",\"Solution\"]}]]}],[\"$\",\"li\",\"2\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#why\",\"id\":\"toc-why\",\"children\":[\"Why\"]}]]}],[\"$\",\"li\",\"3\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#final-solution\",\"id\":\"toc-final-solution\",\"children\":[\"Final\",\" \",\"Solution\"]}]]}]]}]]}],[\"$\",\"article\",\"1\",{\"children\":[[\"$\",\"$L1c\",null,{\"type\":\"warning\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"This\",\" \",\"article\",\" \",\"was\",\" \",\"translated\",\" \",\"from\",\" \",\"Chinese\",\" \",\"by\",\" \",\"ChatGPT\",\" \",\"and\",\" \",\"may\",\" \",\"contain\",\" \",\"some\",\" \",\"errors.\"]}]]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"display\",\" \",\"of\",\" \",\"line\",\" \",\"numbers\",\" \",\"(Line\",\" \",\"Number)\",\" \",\"should\",\" \",\"not\",\" \",\"be\",\" \",\"a\",\" \",\"problem.\",\" \",\"There\",\" \",\"is\",\" \",\"even\",\" \",\"an\",\" \",[\"$\",\"a\",\"0\",{\"href\":\"https://github.com/Microsoft/vscode/issues/52735\",\"children\":[\"issue\"]}],\" \",\"in\",\" \",\"the\",\" \",\"vscode\",\" \",\"repository\",\" \",\"asking\",\" \",\"how\",\" \",\"to\",\" \",\"conveniently\",\" \",\"turn\",\" \",\"off\",\" \",\"the\",\" \",\"line\",\" \",\"number\",\" \",\"display.\",\" \",\"For\",\" \",\"Vim\",\" \",\"users,\",\" \",\"a\",\" \",\"simple\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"set :number\"]}],\" \",\"can\",\" \",\"turn\",\" \",\"on\",\" \",\"the\",\" \",\"line\",\" \",\"number\",\" \",\"display.\"]}],[\"$\",\"p\",null,{\"children\":[\"Yes,\",\" \",\"Emacs\",\" \",\"is\",\" \",\"such\",\" \",\"a\",\" \",\"special\",\" \",\"editor.\",\" \",\"For\",\" \",\"occasional\",\" \",\"users\",\" \",\"like\",\" \",\"me,\",\" \",\"the\",\" \",\"display\",\" \",\"of\",\" \",\"line\",\" \",\"numbers\",\" \",\"is\",\" \",\"indeed\",\" \",\"a\",\" \",\"problem\",\" \",\"that\",\" \",\"troubles\",\" \",\"me.\"]}],[\"$\",\"h2\",null,{\"className\":\"text-3xl\",\"id\":\"what-is-the-problem\",\"children\":[[\"$\",\"$L1d\",null,{\"href\":\"#what-is-the-problem\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[\"What\",\" \",\"is\",\" \",\"the\",\" \",\"problem\"]]}],[\"$\",\"p\",null,{\"children\":[\"I\",\" \",\"am\",\" \",\"using\",\" \",\"a\",\" \",\"distribution\",\" \",\"of\",\" \",\"Emacs,\",\" \",\"or\",\" \",\"a\",\" \",\"mature\",\" \",\"configuration\",\" \",\"file,\",\" \",[\"$\",\"a\",\"0\",{\"href\":\"https://www.spacemacs.org/\",\"children\":[\"Spacemacs\"]}],\".\",\" \",\"In\",\" \",\"the\",\" \",\"official\",\" \",\"Spacemacs\",\" \",\"documentation,\",\" \",\"to\",\" \",\"enable\",\" \",\"line\",\" \",\"number\",\" \",\"display,\",\" \",\"you\",\" \",\"only\",\" \",\"need\",\" \",\"to\",\" \",\"set\",\" \",\"a\",\" \",\"variable\",\" \",\"in\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\".spacemacs\"]}],\":\"]}],[\"$\",\"$L1e\",\"5\",{\"className\":\"elisp\",\"children\":[\"(setq-default dotspacemacs-line-numbers t)\"]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"meaning\",\" \",\"of\",\" \",\"this\",\" \",\"sentence\",\" \",\"is\",\" \",\"to\",\" \",\"set\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"dotspacemacs-line-numbers\"]}],\" \",\"to\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"t\"]}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"At\",\" \",\"the\",\" \",\"same\",\" \",\"time,\",\" \",\"to\",\" \",\"support\",\" \",\"the\",\" \",\"coq\",\" \",\"language,\",\" \",\"I\",\" \",\"also\",\" \",\"loaded\",\" \",\"the\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq\"]}],\" \",\"layer.\",\" \",\"But\",\" \",\"if\",\" \",\"you\",\" \",\"open\",\" \",\"a\",\" \",\"coq\",\" \",\"file,\",\" \",\"you\",\" \",\"may\",\" \",\"be\",\" \",\"surprised\",\" \",\"to\",\" \",\"find\",\" \",\"that\",\" \",\"the\",\" \",\"coq\",\" \",\"source\",\" \",\"code\",\" \",\"does\",\" \",\"not\",\" \",\"have\",\" \",\"line\",\" \",\"numbers:\"]}],[\"$\",\"figure\",\"8\",{\"children\":[[\"$\",\"div\",null,{\"children\":[[\"$\",\"img\",\"0\",{\"src\":\"https://pic.superbed.cc/item/656efcb312f8d922c1008d4a.png\"}]]}]]}],[\"$\",\"p\",null,{\"children\":[\"According\",\" \",\"to\",\" \",\"normal\",\" \",\"intuition,\",\" \",\"setting\",\" \",\"to\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"t\"]}],\" \",\"should\",\" \",\"display\",\" \",\"line\",\" \",\"numbers\",\" \",\"in\",\" \",\"all\",\" \",\"cases.\",\" \",\"So,\",\" \",\"why\",\" \",\"are\",\" \",\"there\",\" \",\"no\",\" \",\"line\",\" \",\"numbers?\"]}],[\"$\",\"h2\",null,{\"className\":\"text-3xl\",\"id\":\"temporary-solution\",\"children\":[[\"$\",\"$L1d\",null,{\"href\":\"#temporary-solution\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[\"Temporary\",\" \",\"Solution\"]]}],[\"$\",\"p\",null,{\"children\":[\"Solving\",\" \",\"this\",\" \",\"problem\",\" \",\"is\",\" \",\"actually\",\" \",\"easier\",\" \",\"than\",\" \",\"figuring\",\" \",\"out\",\" \",\"the\",\" \",\"reason.\"]}],[\"$\",\"p\",null,{\"children\":[\"After\",\" \",\"a\",\" \",\"little\",\" \",\"search,\",\" \",\"I\",\" \",\"found\",\" \",\"that\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"spc t n\"]}],\" \",[\"$\",\"sup\",\"1\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#note-1\",\"id\":\"note-anchor-1\",\"children\":[\"1\"]}]]}],\" \",\"can\",\" \",\"turn\",\" \",\"on\",\" \",\"line\",\" \",\"numbers\",\" \",\"in\",\" \",\"the\",\" \",\"current\",\" \",\"buffer,\",\" \",\"which\",\" \",\"can\",\" \",\"indeed\",\" \",\"solve\",\" \",\"the\",\" \",\"problem.\",\" \",\"According\",\" \",\"to\",\" \",\"the\",\" \",\"Emacs\",\" \",\"wiki,\",\" \",\"this\",\" \",\"shortcut\",\" \",\"actually\",\" \",\"calls\",\" \",\"the\",\" \",\"line\",\" \",\"number\",\" \",\"command\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"display-line-numbers-mode\"]}],\" \",\"introduced\",\" \",\"after\",\" \",\"Emacs\",\" \",\"26.1\",\" \",\"version.\"]}],[\"$\",\"p\",null,{\"children\":[\"Emacs\",\" \",\"commands\",\" \",\"can\",\" \",\"be\",\" \",\"executed\",\" \",\"through\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"m-x\"]}],\",\",\" \",\"or\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"spc spc\"]}],\".\",\" \",\"In\",\" \",\"fact,\",\" \",\"a\",\" \",\"command\",\" \",\"is\",\" \",\"an\",\" \",\"Emacs\",\" \",\"Lisp\",\" \",\"function.\",\" \",\"According\",\" \",\"to\",\" \",\"the\",\" \",[\"$\",\"a\",\"2\",{\"href\":\"https://www.gnu.org/software/emacs/manual/html_node/eintr/Interactive-multiply_002dby_002dseven.html\",\"children\":[\"documentation\"]}],\" \",\"of\",\" \",\"Programming\",\" \",\"Elisp,\",\" \",\"as\",\" \",\"long\",\" \",\"as\",\" \",\"there\",\" \",\"is\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"(interactive)\"]}],\" \",\"in\",\" \",\"the\",\" \",\"function\",\" \",\"definition\",\" \",\"of\",\" \",\"a\",\" \",\"function,\",\" \",\"it\",\" \",\"can\",\" \",\"be\",\" \",\"called\",\" \",\"as\",\" \",\"a\",\" \",\"command.\"]}],[\"$\",\"p\",null,{\"children\":[\"Clearly,\",\" \",\"Spacemacs\",\" \",\"also\",\" \",\"sets\",\" \",\"line\",\" \",\"numbers\",\" \",\"through\",\" \",\"this\",\" \",\"function.\",\" \",\"Although\",\" \",\"I\",\" \",\"donâ€™t\",\" \",\"know\",\" \",\"why\",\" \",\"Spacemacs\",\" \",\"didnâ€™t\",\" \",\"turn\",\" \",\"on\",\" \",\"line\",\" \",\"numbers\",\" \",\"for\",\" \",\"my\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\".v\"]}],\" \",\"files,\",\" \",\"we\",\" \",\"can\",\" \",\"turn\",\" \",\"them\",\" \",\"on\",\" \",\"ourselves.\"]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq\"]}],\" \",\"layer\",\" \",\"actually\",\" \",\"uses\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq-mode\"]}],\".\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"coq-mode\"]}],\" \",\"is\",\" \",\"a\",\" \",[\"$\",\"a\",\"3\",{\"href\":\"https://www.gnu.org/software/emacs/manual/html_node/emacs/Major-Modes.html\",\"children\":[\"Major\",\" \",\"Mode\"]}],\" \",\"of\",\" \",\"Emacs,\",\" \",\"which\",\" \",\"provides\",\" \",\"support\",\" \",\"for\",\" \",\"the\",\" \",\"coq\",\" \",\"language\",\" \",\"and\",\" \",\"defines\",\" \",\"a\",\" \",\"bunch\",\" \",\"of\",\" \",\"shortcuts.\"]}],[\"$\",\"p\",null,{\"children\":[\"Emacs\",\" \",\"supports\",\" \",\"a\",\" \",\"mechanism\",\" \",\"called\",\" \",[\"$\",\"a\",\"0\",{\"href\":\"https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html\",\"children\":[\"Hooks\"]}],\",\",\" \",\"which\",\" \",\"allows\",\" \",\"us\",\" \",\"to\",\" \",\"perform\",\" \",\"a\",\" \",\"series\",\" \",\"of\",\" \",\"operations\",\" \",\"when\",\" \",\"a\",\" \",\"mode\",\" \",\"is\",\" \",\"loaded.\",\" \",\"Since\",\" \",\"Spacemacs\",\" \",\"wonâ€™t\",\" \",\"turn\",\" \",\"on\",\" \",\"line\",\" \",\"numbers\",\" \",\"for\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq-mode\"]}],\",\",\" \",\"we\",\" \",\"manually\",\" \",\"execute\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"display-line-numbers-mode\"]}],\" \",\"through\",\" \",\"this\",\" \",\"mechanism.\"]}],[\"$\",\"$L1e\",\"17\",{\"className\":\"elisp\",\"children\":[\"(defun dotspacemacs/user-config ()\\n  \\\"Configuration for user code:\\nThis function is called at the very end of Spacemacs startup, after layer\\nconfiguration.\\nPut your configuration code here, except for variables that should be set\\nbefore packages are loaded.\\\"\\n  (add-hook 'coq-mode-hook (lambda () (display-line-numbers-mode 1)))\\n)\"]}],[\"$\",\"p\",null,{\"children\":[\"Here,\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"dotspacemacs/user-config\"]}],\" \",\"is\",\" \",\"part\",\" \",\"of\",\" \",\"the\",\" \",\"Spacemacs\",\" \",\"configuration\",\" \",\"file,\",\" \",\"where\",\" \",\"you\",\" \",\"can\",\" \",\"perform\",\" \",\"some\",\" \",\"custom\",\" \",\"operations.\"]}],[\"$\",\"p\",null,{\"children\":[\"This\",\" \",\"of\",\" \",\"course\",\" \",\"solves\",\" \",\"the\",\" \",\"problem.\",\" \",\"In\",\" \",\"fact,\",\" \",\"Spacemacs\",\" \",\"also\",\" \",\"mentions\",\" \",\"an\",\" \",\"option\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\":enabled-for-modes\"]}],\" \",\"in\",\" \",\"the\",\" \",\"documentation.\",\" \",\"Adding\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq-mode\"]}],\" \",\"to\",\" \",\"this\",\" \",\"option\",\" \",\"can\",\" \",\"directly\",\" \",\"solve\",\" \",\"the\",\" \",\"problem.\",\" \",\"However,\",\" \",\"I\",\" \",\"didnâ€™t\",\" \",\"discover\",\" \",\"this\",\" \",\"option\",\" \",\"until\",\" \",\"I\",\" \",\"figured\",\" \",\"out\",\" \",\"the\",\" \",\"source\",\" \",\"of\",\" \",\"the\",\" \",\"problem.\"]}],[\"$\",\"$L1e\",\"20\",{\"className\":\"elisp\",\"children\":[\"(setq-default dotspacemacs-line-numbers\\n  '(:enabled-for-modes coq-mode))\"]}],[\"$\",\"h2\",null,{\"className\":\"text-3xl\",\"id\":\"why\",\"children\":[[\"$\",\"$L1d\",null,{\"href\":\"#why\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[\"Why\"]]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"first\",\" \",\"thing\",\" \",\"I\",\" \",\"noticed\",\" \",\"was\",\" \",\"the\",\" \",\"comment\",\" \",\"for\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"dotspacemacs-line-numbers\"]}],\":\"]}],[\"$\",\"$L1e\",\"23\",{\"className\":\"elisp\",\"children\":[\";; Control line numbers activation.\\n;; If set to `t', `relative' or `visual' then line numbers are enabled in all\\n;; `prog-mode' and `text-mode' derivatives. If set to `relative', line\\n;; numbers are relative. If set to `visual', line numbers are also relative,\\n;; but only visual lines are counted. For example, folded lines will not be\\n;; counted and wrapped lines are counted as multiple lines.\\n;; This variable can also be set to a property list for finer control:\\n;; (default nil)\"]}],[\"$\",\"p\",null,{\"children\":[\"This\",\" \",\"comment\",\" \",\"mentions\",\" \",\"that\",\" \",\"if\",\" \",\"this\",\" \",\"variable\",\" \",\"is\",\" \",\"set\",\" \",\"to\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"t\"]}],\",\",\" \",\"it\",\" \",\"will\",\" \",\"enable\",\" \",\"line\",\" \",\"numbers\",\" \",\"by\",\" \",\"default\",\" \",\"in\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"prog-mode\"]}],\" \",\"and\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"text-mode\"]}],\".\",\" \",\"These\",\" \",\"two\",\" \",\"modes\",\" \",\"are\",\" \",\"known\",\" \",\"as\",\" \",[\"$\",\"a\",\"3\",{\"href\":\"https://www.gnu.org/software/emacs/manual/html_node/elisp/Basic-Major-Modes.html\",\"children\":[\"Basic\",\" \",\"Major\",\" \",\"Modes\"]}],\".\",\" \",\"A\",\" \",\"natural\",\" \",\"guess\",\" \",\"is\",\" \",\"that\",\" \",[\"$\",\"code\",\"4\",{\"children\":[\"coq-mode\"]}],\" \",\"is\",\" \",\"not\",\" \",\"one\",\" \",\"of\",\" \",\"them.\"]}],[\"$\",\"p\",null,{\"children\":[\"Open\",\" \",\"a\",\" \",\"coq\",\" \",\"file,\",\" \",\"execute\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"m-x describe-mode\"]}],\",\",\" \",\"and\",\" \",\"you\",\" \",\"will\",\" \",\"see:\"]}],[\"$\",\"$L1e\",\"26\",{\"children\":[\"Coq mode defined in â€˜coq-mode.elâ€™:\\nMajor mode for Coq scripts.\"]}],[\"$\",\"p\",null,{\"children\":[\"Enter\",\" \",\"the\",\" \",\"source\",\" \",\"code\",\" \",\"of\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq-mode.el\"]}],\" \",\"to\",\" \",\"take\",\" \",\"a\",\" \",\"look,\",\" \",\"the\",\" \",\"mystery\",\" \",\"lies\",\" \",\"in\",\" \",\"line\",\" \",\"182:\"]}],[\"$\",\"$L1e\",\"28\",{\"className\":\"elisp\",\"children\":[\"(defun coq--parent-mode ()\\n  (if coq-use-pg (proof-mode) (prog-mode)))\\n\\n;;;###autoload\\n(define-derived-mode coq-mode coq--parent-mode \\\"Coq\\\"\\n  \\\"Major mode for Coq scripts.\"]}],[\"$\",\"p\",null,{\"children\":[\"This\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq--parent-mode\"]}],\" \",\"is\",\" \",\"obviously\",\" \",\"the\",\" \",\"parent\",\" \",\"mode\",\" \",\"of\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq-mode\"]}],\" \",\"(parent\",\" \",\"mode),\",\" \",\"Emascâ€™s\",\" \",\"mode\",\" \",\"also\",\" \",\"has\",\" \",\"an\",\" \",\"inheritance\",\" \",\"tree,\",\" \",\"a\",\" \",\"mode\",\" \",\"inherits\",\" \",\"another\",\" \",\"parent\",\" \",\"mode,\",\" \",\"the\",\" \",\"root\",\" \",\"of\",\" \",\"this\",\" \",\"tree\",\" \",\"is\",\" \",\"uncertain,\",\" \",\"there\",\" \",\"are\",\" \",\"several\",\" \",\"situations:\"]}],[\"$\",\"ul\",\"30\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[\"Itself\"]}],[\"$\",\"li\",\"1\",{\"children\":[\"Fundamental\",\" \",\"Mode\"]}],[\"$\",\"li\",\"2\",{\"children\":[\"Basic\",\" \",\"Major\",\" \",\"Mode\"]}]]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"value\",\" \",\"of\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq-use-pg\"]}],\" \",\"in\",\" \",\"my\",\" \",\"environment\",\" \",\"is\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"t\"]}],\",\",\" \",\"and\",\" \",\"its\",\" \",\"parent\",\" \",\"mode\",\" \",\"is\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"proof-mode\"]}],\".\",\" \",\"What\",\" \",\"is\",\" \",\"the\",\" \",\"parent\",\" \",\"mode\",\" \",\"of\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"proof-mode\"]}],\"?\"]}],[\"$\",\"p\",null,{\"children\":[\"A\",\" \",[\"$\",\"a\",\"0\",{\"href\":\"https://emacs.stackexchange.com/questions/58073/how-to-find-inheritance-of-modes\",\"children\":[\"question\"]}],\" \",\"on\",\" \",\"StackOverflow\",\" \",\"provides\",\" \",\"the\",\" \",\"relevant\",\" \",\"code:\"]}],[\"$\",\"$L1e\",\"33\",{\"className\":\"elisp\",\"children\":[\"(defun derived-modes (mode)\\n  \\\"Return a list of the ancestor modes that MODE is derived from.\\\"\\n  (let ((modes   ())\\n        (parent  nil))\\n    (while (setq parent (get mode 'derived-mode-parent))\\n      (push parent modes)\\n      (setq mode parent))\\n    (setq modes  (nreverse modes))))\"]}],[\"$\",\"p\",null,{\"children\":[\"With\",\" \",\"this\",\" \",\"function,\",\" \",\"you\",\" \",\"can\",\" \",\"indeed\",\" \",\"get\",\" \",\"the\",\" \",\"inheritance\",\" \",\"path\",\" \",\"of\",\" \",\"some\",\" \",[\"$\",\"q\",\"0\",{\"children\":[\"normal\"]}],\" \",\"modes,\",\" \",\"such\",\" \",\"as\",\" \",\"the\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"proof-mode\"]}],\" \",\"we\",\" \",\"just\",\" \",\"mentioned:\"]}],[\"$\",\"$L1e\",\"35\",{\"className\":\"elisp\",\"children\":[\"ELISP\u003e (derived-modes 'proof-mode)\\n(prog-mode)\"]}],[\"$\",\"p\",null,{\"children\":[\"Yes,\",\" \",\"the\",\" \",\"parent\",\" \",\"mode\",\" \",\"of\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"proof-mode\"]}],\" \",\"is\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"prog-mode\"]}],\".\",\" \",\"If\",\" \",\"you\",\" \",\"still\",\" \",\"remember\",\" \",\"the\",\" \",\"document\",\" \",\"just\",\" \",\"now,\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"prog-mode\"]}],\" \",\"should\",\" \",\"also\",\" \",\"display\",\" \",\"line\",\" \",\"numbers\",\" \",\"when\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"dotspacemacs-line-numbers\"]}],\" \",\"is\",\" \",\"set\",\" \",\"to\",\" \",[\"$\",\"code\",\"4\",{\"children\":[\"t\"]}],\".\"]}],[\"$\",\"p\",null,{\"children\":[\"So,\",\" \",\"what\",\" \",\"went\",\" \",\"wrong?\",\" \",\"Letâ€™s\",\" \",\"input\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"'coq-mode\"]}],\" \",\"into\",\" \",\"this\",\" \",\"function:\"]}],[\"$\",\"$L1e\",\"38\",{\"className\":\"elisp\",\"children\":[\"ELISP\u003e (derived-modes 'coq-mode)\\n(coq--parent-mode)\"]}],[\"$\",\"p\",null,{\"children\":[\"Its\",\" \",\"output\",\" \",\"is\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"(coq--parent-mode)\"]}],\",\",\" \",\"which\",\" \",\"is\",\" \",\"just\",\" \",\"the\",\" \",\"symbol\",\" \",\"of\",\" \",\"the\",\" \",\"parent\",\" \",\"mode,\",\" \",\"not\",\" \",\"the\",\" \",\"evaluated\",\" \",\"parent\",\" \",\"mode.\",\" \",\"It\",\" \",\"can\",\" \",\"be\",\" \",\"seen\",\" \",\"that\",\" \",\"the\",\" \",\"expression\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"(get 'coq-mode 'derived-parent-mode)\"]}],\" \",\"can\",\" \",\"only\",\" \",\"get\",\" \",\"the\",\" \",\"symbol\",\" \",\"in\",\" \",\"syntax,\",\" \",\"not\",\" \",\"its\",\" \",\"real\",\" \",\"parent\",\" \",\"mode.\",\" \",\"Checking\",\" \",\"the\",\" \",\"source\",\" \",\"code\",\" \",\"of\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"define-derived-mode\"]}],\",\",\" \",\"you\",\" \",\"can\",\" \",\"find\",\" \",\"that\",\" \",\"what\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"(get mode 'derived-mode-parent)\"]}],\" \",\"gets\",\" \",\"is\",\" \",\"the\",\" \",\"parent\",\" \",\"mode\",\" \",\"set\",\" \",\"by\",\" \",\"this\",\" \",\"sentence:\"]}],[\"$\",\"$L1e\",\"40\",{\"className\":\"elisp\",\"children\":[\"(put ',child 'derived-mode-parent ',parent)\"]}],[\"$\",\"p\",null,{\"children\":[\"So,\",\" \",\"is\",\" \",\"this\",\" \",\"how\",\" \",\"Spacemacs\",\" \",\"gets\",\" \",\"the\",\" \",\"parent\",\" \",\"mode?\",\" \",\"Spacemacs\",\" \",\"checks\",\" \",\"whether\",\" \",\"line\",\" \",\"number\",\" \",\"display\",\" \",\"is\",\" \",\"enabled\",\" \",\"in\",\" \",\"the\",\" \",\"current\",\" \",\"mode\",\" \",\"in\",\" \",\"the\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"spacemacs//linum-enabled-for-current-major-mode\"]}],\" \",\"function\",\" \",\"in\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"spacemacs/layers/+spacemacs/spacemacs-defaults/funcs.el\"]}],\":\"]}],[\"$\",\"$L1e\",\"42\",{\"className\":\"elisp\",\"children\":[\"$1f\"]}],[\"$\",\"p\",null,{\"children\":[\"As\",\" \",\"you\",\" \",\"can\",\" \",\"see,\",\" \",\"it\",\" \",\"asks\",\" \",\"the\",\" \",\"current\",\" \",\"bufferâ€™s\",\" \",\"major\",\" \",\"mode\",\" \",\"if\",\" \",\"it\",\" \",\"is\",\" \",\"a\",\" \",\"child\",\" \",\"mode\",\" \",\"of\",\" \",\"the\",\" \",\"preset\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"enabled-for-modes\"]}],\" \",\"through\",\" \",\"the\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"derived-mode-p\"]}],\" \",\"function.\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"dervied-mode-p\"]}],\" \",\"is\",\" \",\"a\",\" \",\"function\",\" \",\"provided\",\" \",\"by\",\" \",\"Emacs,\",\" \",\"and\",\" \",\"the\",\" \",[\"$\",\"a\",\"3\",{\"href\":\"https://doc.endlessparentheses.com/Fun/derived-mode-p.html\",\"children\":[\"documentation\"]}],\" \",\"claims\",\" \",\"that\",\" \",\"if\",\" \",\"the\",\" \",\"current\",\" \",\"bufferâ€™s\",\" \",\"main\",\" \",\"mode\",\" \",\"is\",\" \",\"a\",\" \",\"child\",\" \",\"mode\",\" \",\"of\",\" \",[\"$\",\"code\",\"4\",{\"children\":[\"modes\"]}],\",\",\" \",\"then\",\" \",[\"$\",\"code\",\"5\",{\"children\":[\"(derived-mode-p modes)\"]}],\" \",\"will\",\" \",\"return\",\" \",\"a\",\" \",\"non-\",[\"$\",\"code\",\"6\",{\"children\":[\"nil\"]}],\" \",\"value.\"]}],[\"$\",\"p\",null,{\"children\":[\"Upon\",\" \",\"further\",\" \",\"inspection\",\" \",\"of\",\" \",\"the\",\" \",\"source\",\" \",\"code\",\" \",\"of\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"derived-mode-p\"]}],\",\",\" \",\"we\",\" \",\"finally\",\" \",\"found\",\" \",\"the\",\" \",\"root\",\" \",\"of\",\" \",\"the\",\" \",\"problem.\"]}],[\"$\",\"$L1e\",\"45\",{\"className\":\"elisp\",\"children\":[\"(defun provided-mode-derived-p (mode \u0026rest modes)\\n  \\\"Non-nil if MODE is derived from one of MODES or their aliases.\\nUses the `derived-mode-parent' property of the symbol to trace backwards.\\nIf you just want to check `major-mode', use `derived-mode-p'.\\\"\\n  (while\\n      (and\\n       (not (memq mode modes))\\n       (let* ((parent (get mode 'derived-mode-parent))\\n              (parentfn (symbol-function parent)))\\n         (setq mode (if (and parentfn (symbolp parentfn)) parentfn parent)))))\\n  mode)\\n\\n(defun derived-mode-p (\u0026rest modes)\\n  \\\"Non-nil if the current major mode is derived from one of MODES.\\nUses the `derived-mode-parent' property of the symbol to trace backwards.\\\"\\n  (apply #'provided-mode-derived-p major-mode modes))\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"dervied-mode-p\"]}],\" \",\"also\",\" \",\"gets\",\" \",\"the\",\" \",\"parent\",\" \",\"mode\",\" \",\"of\",\" \",\"a\",\" \",\"certain\",\" \",\"mode\",\" \",\"through\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"(get mode 'derived-mode-parent)\"]}],\",\",\" \",\"but\",\" \",\"for\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"coq-mode\"]}],\",\",\" \",\"it\",\" \",\"will\",\" \",\"get\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"coq--parent-mode\"]}],\",\",\" \",\"and\",\" \",\"the\",\" \",\"inheritance\",\" \",\"chain\",\" \",\"breaks\",\" \",\"here.\"]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"final\",\" \",\"definition\",\" \",\"of\",\" \",\"mode\",\" \",\"in\",\" \",\"Emacs\",\" \",\"is\",\" \",\"indeed\",\" \",\"a\",\" \",\"function.\",\" \",\"However,\",\" \",\"if\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"'parent\"]}],\" \",\"cannot\",\" \",\"evaluate\",\" \",\"the\",\" \",\"correct\",\" \",\"parent\",\" \",\"mode,\",\" \",\"Emacsâ€™\",\" \",\"preset\",\" \",\"function\",\" \",\"for\",\" \",\"mode\",\" \",\"will\",\" \",\"not\",\" \",\"get\",\" \",\"the\",\" \",\"expected\",\" \",\"result.\",\" \",\"Obviously,\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq-mode\"]}],\" \",\"should\",\" \",\"not\",\" \",\"define\",\" \",[\"$\",\"code\",\"2\",{\"children\":[\"coq--parent-mode\"]}],\" \",\"in\",\" \",\"this\",\" \",\"way.\",\" \",\"So,\",\" \",\"how\",\" \",\"should\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"coq--parent-mode\"]}],\" \",\"be\",\" \",\"defined?\"]}],[\"$\",\"h2\",null,{\"className\":\"text-3xl\",\"id\":\"final-solution\",\"children\":[[\"$\",\"$L1d\",null,{\"href\":\"#final-solution\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[\"Final\",\" \",\"Solution\"]]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"global\",\" \",\"variables\",\" \",\"and\",\" \",\"global\",\" \",\"functions\",\" \",\"of\",\" \",\"Emacs\",\" \",\"Lisp\",\" \",\"are\",\" \",\"different,\",\" \",\"which\",\" \",\"is\",\" \",\"very\",\" \",\"different\",\" \",\"from\",\" \",\"Scheme.\",\" \",\"If\",\" \",\"you\",\" \",\"directly\",\" \",\"define\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq--parent-mode\"]}],\" \",\"as\",\" \",\"a\",\" \",\"variable,\",\" \",\"it\",\" \",\"will\",\" \",\"make\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq-mode\"]}],\" \",\"unable\",\" \",\"to\",\" \",\"load.\"]}],[\"$\",\"$L1e\",\"50\",{\"className\":\"elisp\",\"children\":[\"(defvar coq--parent-mode\\n  (if coq-use-pg 'proof-mode 'prog-mode))\"]}],[\"$\",\"p\",null,{\"children\":[\"Fortunately,\",\" \",\"Emacs\",\" \",\"Lisp\",\" \",\"provides\",\" \",\"a\",\" \",\"function\",\" \",\"called\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"defalias\"]}],\",\",\" \",\"which\",\" \",\"can\",\" \",\"define\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"coq--parent-mode\"]}],\" \",\"as\",\" \",\"an\",\" \",\"alias.\"]}],[\"$\",\"$L1e\",\"52\",{\"className\":\"elisp\",\"children\":[\"(defalias 'coq--parent-mode\\n  (if coq-use-pg 'proof-mode 'prog-mode))\"]}],[\"$\",\"p\",null,{\"children\":[\"The\",\" \",\"above\",\" \",\"modification\",\" \",\"is\",\" \",\"enough\",\" \",\"to\",\" \",\"make\",\" \",\"Spacemacs\",\" \",\"automatically\",\" \",\"detect\",\" \",\"that\",\" \",[\"$\",\"code\",\"0\",{\"children\":[\"coq-mode\"]}],\" \",\"is\",\" \",\"derived\",\" \",\"from\",\" \",[\"$\",\"code\",\"1\",{\"children\":[\"prog-mode\"]}],\",\",\" \",\"thus\",\" \",\"turning\",\" \",\"on\",\" \",\"line\",\" \",\"number\",\" \",\"display.\",\" \",\"I\",\" \",\"have\",\" \",\"submitted\",\" \",\"a\",\" \",[\"$\",\"a\",\"2\",{\"href\":\"https://github.com/ProofGeneral/PG/pull/717\",\"children\":[\"PR\"]}],\" \",\"and\",\" \",\"merged\",\" \",\"it\",\" \",\"into\",\" \",\"the\",\" \",\"main\",\" \",\"branch.\"]}],[\"$\",\"div\",null,{\"className\":\"notes\",\"children\":[[\"$\",\"$L20\",null,{\"itemId\":\"1\",\"id\":\"note-1\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"If\",\" \",\"you\",\" \",\"are\",\" \",\"not\",\" \",\"familiar\",\" \",\"with\",\" \",\"this\",\" \",\"shortcut\",\" \",\"notation,\",\" \",\"you\",\" \",\"can\",\" \",\"refer\",\" \",\"to\",\" \",\"the\",\" \",[\"$\",\"a\",\"0\",{\"href\":\"https://kb.iu.edu/d/aghb\",\"children\":[\"documentation\"]}]]}]]}]]}]]}]]}]]}]\n"])</script></body></html>