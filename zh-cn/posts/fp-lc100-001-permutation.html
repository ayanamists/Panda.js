<!DOCTYPE html><html lang="zh-cn"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/57e8d276a38ab64c.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/ad2762ca96cee671.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/97d548e729a05adf.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-f70da49b2a689e16.js"/><script src="/_next/static/chunks/1dd3208c-0a1ade3a7807b4cc.js" async=""></script><script src="/_next/static/chunks/286-ccdecb91557a793d.js" async=""></script><script src="/_next/static/chunks/main-app-1543724a55492158.js" async=""></script><script src="/_next/static/chunks/706-97ed238ee5a03fb5.js" async=""></script><script src="/_next/static/chunks/469-7ee2e4c850f58403.js" async=""></script><script src="/_next/static/chunks/911-e9f556f9b03e931c.js" async=""></script><script src="/_next/static/chunks/373-fbdb9516436dc720.js" async=""></script><script src="/_next/static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js" async=""></script><script src="/_next/static/chunks/61af6f7f-9cff01d0fc100f98.js" async=""></script><script src="/_next/static/chunks/306-ef157ce75cbf9e7a.js" async=""></script><script src="/_next/static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-8ab52a4fba20768e.js" async=""></script><title>Aya&#x27;s Blog</title><meta name="description" content="A site powered by next.js and pandoc"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="text-foreground bg-background min-h-screen"><div data-overlay-container="true"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav class="flex z-40 w-full h-auto items-center justify-center data-[menu-open=true]:border-none sticky top-0 inset-x-0 backdrop-blur-lg data-[menu-open=true]:backdrop-blur-xl backdrop-saturate-150 bg-background/70" style="--navbar-height:4rem;transform:none"><header class="z-40 flex px-6 gap-4 w-full flex-row relative flex-nowrap items-center justify-between h-[var(--navbar-height)] max-w-[1024px]"><div class="basis-0 flex-grow flex-nowrap justify-start bg-transparent items-center no-underline text-medium whitespace-nowrap box-border flex flex-row gap-4"><p class="font-bold text-inherit"><a aria-label="主页" href="/zh-cn">主页</a></p><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"><a class="font-bold" aria-label="博客" href="/zh-cn/blog">博客</a></li><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"><a class="font-bold" aria-label="园地" href="/zh-cn/favorites">园地</a></li></div><ul class="flex h-full flex-row flex-nowrap items-center data-[justify=start]:justify-start data-[justify=start]:flex-grow data-[justify=start]:basis-0 data-[justify=center]:justify-center data-[justify=end]:justify-end data-[justify=end]:flex-grow data-[justify=end]:basis-0 gap-1" data-justify="end"><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"><button class="group relative inline-flex items-center justify-center box-border appearance-none select-none whitespace-nowrap overflow-hidden tap-highlight-transparent outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 gap-2 rounded-medium px-0 !gap-0 data-[pressed=true]:scale-[0.97] transition-transform-colors-opacity motion-reduce:transition-none bg-transparent text-default-foreground data-[hover=true]:bg-default/40 min-w-10 w-10 h-10 z-10 aria-expanded:scale-[0.97] aria-expanded:opacity-70 subpixel-antialiased text-md font-bold" type="button" aria-label="Select Language" data-slot="trigger" id="react-aria-:R1j6fja:" aria-haspopup="true" aria-expanded="false"><span class="text-foreground">文/A</span></button></li><li class="text-medium whitespace-nowrap box-border list-none data-[active=true]:font-semibold"></li></ul></header></nav><div class=" relative w-full py-12 shadow-xl shadow-slate-700/20 ring-1 ring-gray-900/5 dark:shadow-slate-100/20 dark:ring-gray-100/5 lg:mx-auto lg:max-w-4xl lg:pt-16 lg:pb-28 bg-lightwhite dark:bg-lightblack"><div class="prose prose-natural dark:prose-invert mx-auto max-w-full px-8 sm:px-16 relative"><div><h1 class="text-4xl font-bold mb-2">函数式 Leetcode 百题 – 排列</h1><div class="text-sm text-gray-500 mb-5">4/24/2024</div><div class="xl:absolute xl:-right-8"><div class="xl:fixed xl:max-w-[300px]"><div class="toc"><ul><li><a href="#前言" id="toc-前言">前言</a></li><li><a href="#下一个排列" id="toc-下一个排列">31.<!-- --> <!-- -->下一个排列</a><ul><li><a href="#题目描述" id="toc-题目描述">题目描述</a></li><li><a href="#第一想法" id="toc-第一想法">第一想法</a></li><li><a href="#递归" id="toc-递归">递归</a></li><li><a href="#ismax-的定义" id="toc-ismax-的定义"><code>isMax</code> <!-- -->的定义</a></li><li><a href="#tick-的定义" id="toc-tick-的定义"><code>tick</code> <!-- -->的定义</a></li><li><a href="#更高效的代码" id="toc-更高效的代码">更高效的代码</a></li><li><a href="#总结" id="toc-总结">总结</a></li></ul></li></ul></div></div></div><article><h2 class="text-3xl" id="前言"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#前言">#</a><span class="cjk">前言</span></h2><p><span class="cjk">算法题，是很多程序员的梦魇之一。算法本身当然是有趣的，但不会做题的抓狂、面试回答不出问题的窘迫，没有人会喜欢。</span></p><p><span class="cjk">应对算法题挑战的传统方式是</span> <strong><span class="cjk">刷题</span></strong> <span class="cjk">。</span><span class="cjk">刷题，也就是做大量的题目来学习算法。很多人笃信一种理论，无论是数学学习还是算法学习，都必须进行大量的练习。</span></p><p><span class="cjk">我也认同这种理论。冯诺依曼的箴言还挂在本博客的首页上：</span></p><blockquote><p>Young<!-- --> <!-- -->man,<!-- --> <!-- -->in<!-- --> <!-- -->mathematics<!-- --> <!-- -->you<!-- --> <!-- -->don’t<!-- --> <!-- -->understand<!-- --> <!-- -->things.<!-- --> <!-- -->You<!-- --> <!-- -->just<!-- --> <!-- -->get<!-- --> <!-- -->used<!-- --> <!-- -->to<!-- --> <!-- -->them.</p></blockquote><p><span class="cjk">直觉的认识，直觉的经验，是无比宝贵的财富。练习是获取这种宝贵财富最可靠的手段。简而言之，想要学习算法，你必须刷题，必须练习。</span></p><p><span class="cjk">然而，我确实极度厌烦一种算法学习的常规路径。那就是看到某道题不会做，思考了</span> <!-- -->10<!-- --> <span class="cjk">分钟还是不知道从何入手，那么就去寻找答案。也许你</span> <q><span class="cjk">理解</span></q> <span class="cjk">了答案或者记住了答案，下次看到相同的题目的时候就套进去。只要你见过的答案够多，那么你能</span> <q><span class="cjk">套</span></q> <span class="cjk">的题目也够多。</span></p><p><span class="cjk">为什么我不喜欢这种学习方法呢？也许是我不够聪明吧，我很难</span> <q><span class="cjk">理解</span></q> <span class="cjk">别人给的答案。太多的人只是把最后的高效算法告诉你，而忽略了直觉建立的过程，更别提算法的证明了。从这些人的答案里，我既没有感受到他们对于问题的深刻理解，又没有感受到算法本身的美感。</span></p><p><span class="cjk">难道我们只能通过给</span> <q><span class="cjk">天才</span></q> <span class="cjk">设计的教育来学习算法吗？</span></p><p><span class="cjk">不。世界上还有一群人，在尝试着用纯函数式的语言，用等式推导的方法来设计程序。这些人同样也珍视直觉的价值。他们会从一个清晰而不高效的程序出发，一步步地给出最终的高效算法。在这个过程中，算法的美、算法的</span> <!-- -->insight<!-- --> <span class="cjk">纤毫毕现。已故的</span> <!-- -->Richard<!-- --> <!-- -->Bird，台湾的穆信成老师都是这种方式的先驱。在他们的论文和书籍中，我感受到了一种真正的温柔。</p><p><span class="cjk">我想，虽然等式推导很多时候非常困难，但是把算法的</span> <!-- -->non-trivial<!-- --> <span class="cjk">之处是什么、算法的直觉是什么讲清楚，也许没有那么困难。</span></p><p><span class="cjk">本系列文章就是我的尝试。我将在这些文章中，讲解我是怎么用纯函数式编程解决</span> <!-- -->Leetcode<!-- --> <span class="cjk">的。至于为什么选择</span> <!-- -->Leetcode<!-- --> <span class="cjk">而不是难度更高的</span> <!-- -->Codeforces，我认为难度太高，也许不是好事。高难度的问题很可能需要多个算法共同来处理，而我们更想在每篇文章中关注某类具体的算法。（另一个原因是，我本人对于算法仍然是某种意义的<!-- --> <q><span class="cjk">初学者</span></q><span class="cjk">，难度太高我也处理不来）</span></p><p><span class="cjk">选择</span> <!-- -->Leetcode<!-- --> <span class="cjk">的一个后果是，我们必须用</span> <!-- -->Racket<!-- --> <span class="cjk">或者</span> <!-- -->Scala<!-- --> <span class="cjk">而非</span> <!-- -->Haskell<!-- --> <span class="cjk">来提交代码。这有时候会造成一些困扰，不过我的经验是，大部分我给出的</span> <!-- -->Haskell<!-- --> <span class="cjk">代码可以直接翻译到</span> <!-- -->Scala<!-- --> <span class="cjk">上。每道题目我也会给出对应的</span> <!-- -->Scala<!-- --> <span class="cjk">解。如果确实有问题，比如</span> <!-- -->Scala<!-- --> <span class="cjk">没有</span> <code>Data.Graph</code> <span class="cjk">这种不可变数据结构库，那么我们会视情况退回到非纯函数式编程。不过，这种情况总体应该是较少的。在每道题目的最后，我可能也会把对应的命令式版本给出，也许我们还会探讨一下函数式版本和命令式版本的区别。</span></p><p><span class="cjk">这些文章不是</span> <q><span class="cjk">函数式编程入门</span></q><span class="cjk">。虽然我也许会提示某个库函数的用法，但是总体来说，这些文章假设你已经有了纯函数式编程的基本知识</span> <!-- -->–<!-- --> <!-- -->递归，列表，fold，map<!-- --> <span class="cjk">等等。如果你对函数式编程和</span> <!-- -->Haskell<!-- --> <span class="cjk">语言一无所知，那么在阅读这些文章之前最好简单学习一些</span> <!-- -->Haskell<!-- --> <span class="cjk">知识。以下是我比较推荐的学习资源：</span></p><ul><li><a href="https://www.seas.upenn.edu/~cis1940/spring13/lectures.html">cis194<!-- --> <span class="cjk">课程</span></a></li><li><em>Thinking<!-- --> <!-- -->Functionally<!-- --> <!-- -->With<!-- --> <!-- -->Haskell</em><span class="cjk">，以及其中文翻译版本</span> <a href="https://book.douban.com/subject/26769112/">Haskell函数式程序设计</a></li><li><span class="cjk">练习是重要的，可以通过</span> <a href="https://wiki.haskell.org/99_questions/1_to_10">Haskell<!-- --> <!-- -->99<!-- --> <span class="cjk">题</span></a> <span class="cjk">进行练习。这些练习和</span> <!-- -->Leetcode<!-- --> <span class="cjk">不同，大部分通过直接的递归就可以完成</span></li></ul><blockquote><p><span class="cjk">路漫漫其修远兮，吾将上下而求索</span></p></blockquote><h2 class="text-3xl" id="下一个排列"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#下一个排列">#</a>31.<!-- --> <span class="cjk">下一个排列</span></h2><h3 class="text-2xl" id="题目描述"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#题目描述">#</a><span class="cjk">题目描述</span></h3><p><span class="cjk">以下是</span> <a href="https://leetcode.cn/problems/next-permutation/">Leetcode</a> <span class="cjk">的原始描述：</span></p><blockquote><p><span class="cjk">整数数组的一个</span> <strong><span class="cjk">排列</span></strong> <span class="cjk">就是将其所有成员以序列或线性顺序排列。</span></p><p><span class="cjk">例如，</span><code>arr = [1,2,3]</code> <span class="cjk">，以下这些都可以视作</span> <code>arr</code> <span class="cjk">的排列：</span><code>[1,2,3]</code><span class="cjk">、</span><code>[1,3,2]</code>、`<code>[3,1,2]</code><span class="cjk">、</span><code>[2,3,1]</code> <span class="cjk">。</span><span class="cjk">整数数组的</span> <span class="cjk">下一个排列</span><span class="cjk">是指其整数的下一个字典序更大的排列。更正式地，如果数组的所有排列根据其字典顺序从小到大排列在一个容器中，那么数组的</span> <span class="cjk">下一个排列</span><span class="cjk">就是在这个有序容器中排在它后面的那个排列。如果不存在下一个更大的排列，那么这个数组必须重排为字典序最小的排列（即，其元素按升序排列）。</span></p><p><span class="cjk">例如，</span><code>arr = [1,2,3]</code> <span class="cjk">的下一个排列是</span> <code>[1,3,2]</code> <span class="cjk">。</span><span class="cjk">类似地，</span><code>arr = [2,3,1]</code> <span class="cjk">的下一个排列是</span> <code>[3,1,2]</code> <span class="cjk">。</span><span class="cjk">而</span> <code>arr = [3,2,1]</code> <span class="cjk">的下一个排列是</span> <code>[1,2,3]</code> <span class="cjk">，因为</span> <code>[3,2,1]</code> <span class="cjk">不存在一个字典序更大的排列。</span><span class="cjk">给你一个整数数组</span> <code>nums</code> <span class="cjk">，找出</span> <code>nums</code> <span class="cjk">的下一个排列。</span></p><p><span class="cjk">必须</span><span class="cjk">原地</span> <span class="cjk">修改，只允许使用额外常数空间。</span></p></blockquote><p><span class="cjk">我们是在纯函数式编程。纯函数式编程没有所谓的</span> <q><span class="cjk">修改</span></q><span class="cjk">，所以最后一句话我们无视即可。</span></p><h3 class="text-2xl" id="第一想法"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#第一想法">#</a><span class="cjk">第一想法</span></h3><p>一般来说，很多算法问题能够给一个极为简洁（但低效）的纯函数式解。我们把这个解称之为程序的标准参照（Spec），我们的思考也从这里出发。然而，这个问题却似乎不是这种情况。考虑这个问题的数学表达：</p><div><div class="overflow-auto"><div data-testid="react-katex"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>next</mtext><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="double-struck">P</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="double-struck">P</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mi>m</mi><mi mathvariant="normal">∣</mi><mi>m</mi><mo>∈</mo><mi mathvariant="double-struck">P</mi><mo separator="true">,</mo><mi>m</mi><mo>&gt;</mo><mi>a</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{next}(a) = \begin{cases}
  \min(\mathbb{P}) &amp; a = \max(\mathbb{P}) \\
  \min(\{ m | m \in \mathbb{P}, m &gt; a \}) &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">next</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop">min</span><span class="mopen">(</span><span class="mord mathbb">P</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mop">min</span><span class="mopen">({</span><span class="mord mathnormal">m</span><span class="mord">∣</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbb">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mclose">})</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathbb">P</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></div></div><p><span class="cjk">这没有给我们多少灵感。事实上，在很多编程语言里，把</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">P</mi></mrow><annotation encoding="application/x-tex">\mathbb{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">P</span></span></span></span></span><span class="cjk">，也就是某个列表的所有排列求出来，比这个问题还要麻烦。</span><sup><a href="#note-1" id="note-anchor-1">1</a></sup></p><p><span class="cjk">这种情况下，一个直觉的尝试是，</span><strong><span class="cjk">简单的递归</span></strong> <span class="cjk">能不能解决问题呢？</span></p><h3 class="text-2xl" id="递归"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#递归">#</a><span class="cjk">递归</span></h3><p><span class="cjk">下一个排列函数（记为</span> <code>next</code><span class="cjk">）虽然定义在排列和字典序上，但却显然可以被推广到更泛化的结构上。</span></p><p><span class="cjk">我们首先考查十进制整数的情况。显然地，十进制整数也可以定义</span> <code>next</code> <span class="cjk">函数。这就是大名鼎鼎的</span> <q><span class="cjk">后继</span></q> <span class="cjk">函数，即</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f(x) = x + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> <!-- -->.</p><p><span class="cjk">十进制整数可以被表示为一个列表（或者，命令式语言里的数组），列表中的每个元素表示数字的每一位。例如，</span><span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span></span> <span class="cjk">被表示为</span> <code>[1, 0, 0]</code> <!-- -->.</p><p><span class="cjk">我们特别关心列表表示下的后继函数，因为在这种表示下，</span><code>&gt;=</code> <span class="cjk">恰恰就是字典序比较。我们把列表表示下，十进制整数的后继函数记作</span> <code>next10</code>.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">-- next10 [1, 1, 0] = [1, 1, 1]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token hvariable">next10</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">...</span></code></pre><p><span class="cjk">例如，</span><code>next10 [1, 1, 0] = [1, 1, 1]</code><span class="cjk">。</span></p><p><span class="cjk">这个例子给了我们非常强的直觉。那就是</span> <code>next10 [1, 0] = [1, 1]</code><span class="cjk">，此时</span> <code>next10 [1, 1, 0] = 1 : next10 [1, 0]</code>.<!-- --> <span class="cjk">把这种关系一般化，我们得到对于</span> <code>x:xs</code> <span class="cjk">表示的整数，</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">next10</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">next10</span><span> </span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p><span class="cjk">上式在大部分时候都成立。除非，</span><code>next10 xs</code> <span class="cjk">已经</span> <q><span class="cjk">求不出来了</span></q><span class="cjk">，比如</span> <code>[1, 9, 9]</code> <span class="cjk">的下一个数字（后继）是</span> <code>[2, 0, 0]</code><span class="cjk">，这时就必须要</span> <q><span class="cjk">进位</span></q><span class="cjk">。更严格地说，</span><code>99</code> <span class="cjk">是</span> <strong><span class="cjk">最大</span></strong> <span class="cjk">的两位十进制整数，所以上式不成立。可以证明，只要</span> <code>xs</code> <span class="cjk">还不是最大值，那么上面的等式就成立。</span></p><p><span class="cjk">类似地，同样可以证明题目要求的</span> <code>next</code> <span class="cjk">函数具有同样的性质：当</span> <code>xs</code> <span class="cjk">不是长度为</span> <code>length xs</code> <span class="cjk">的排列的最大值时，</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">next</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">next</span><span> </span><span class="token hvariable">xs</span></code></pre><p><span class="cjk">这个性质实在太过重要，因为我们可以直接构造递归函数：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">next</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token hvariable">isMax</span><span> </span><span class="token hvariable">xs</span><span>  </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">tick</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">otherwise</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">next</span><span> </span><span class="token hvariable">xs</span></code></pre><p><span class="cjk">那么，问题就变成了</span></p><ol><li><span class="cjk">如何定义</span> <code>isMax</code></li><li><span class="cjk">如果</span> <code>xs</code> <span class="cjk">已经是最大值了，那么</span> <code>tick</code> <span class="cjk">函数该怎么定义呢？</span></li></ol><h3 class="text-2xl" id="ismax-的定义"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#ismax-的定义">#</a><code>isMax</code> <span class="cjk">的定义</span></h3><p><span class="cjk">对于一个排列</span> <code>xs</code> <span class="cjk">来说，</span><q><span class="cjk">最大</span></q> <span class="cjk">就是说，无论怎么重新排列，新的</span> <code>xs&#x27;</code> <span class="cjk">一定有</span> <code>xs &gt;= xs&#x27;</code>.</p><p><span class="cjk">什么样的排列具有这种性质呢？一个很自然的想法是，因为这是字典序，所以如果想要排列尽可能大，那就一定要把大的数放在前面。换句话说，</span><q><span class="cjk">降序</span></q> <span class="cjk">的排列一定是最大的。</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">isMax</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">::</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">Ord</span><span> </span><span class="token hvariable">a</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">Bool</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token hvariable">isMax</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">down</span></code></pre><p><span class="cjk">在</span> <!-- -->Haskell<!-- --> <span class="cjk">里，判断一个列表的升降，我们可以使用</span> <q>zip<!-- --> <!-- -->with<!-- --> <!-- -->tail</q> <span class="cjk">的方法。具体来说，就是首先把列表和它的</span> <code>tail</code> <span class="cjk">进行</span> <code>zip</code><span class="cjk">，然后再使用</span> <code>map</code>,<!-- --> <code>all</code> <span class="cjk">之类的函数来判断。</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">dup</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">::</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token hvariable">dup</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">zip</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">tail</span><span> </span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">::</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">Ord</span><span> </span><span class="token hvariable">a</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">Bool</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span></span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">all</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">uncurry</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span></code></pre><h3 class="text-2xl" id="tick-的定义"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#tick-的定义">#</a><code>tick</code> <span class="cjk">的定义</span></h3><p><span class="cjk">如果</span> <code>xs</code> <span class="cjk">已经满足了</span> <code>down</code><span class="cjk">，换言之，它已经是最大的了，那么</span> <code>x:xs</code> <span class="cjk">必须要进行比较复杂的操作才能得到下一个枚举。这个复杂的操作，被我称为</span> <code>tick</code>.</p><p><span class="cjk">例如，</span><code>[2, 4, 3, 1]</code> <span class="cjk">的下一个枚举是</span> <code>[3, 1, 2, 4]</code>.<!-- --> <span class="cjk">这时</span> <code>x</code> <span class="cjk">是</span> <code>2</code>,<!-- --> <code>xs</code> <span class="cjk">是</span> <code>[4, 3, 1]</code><span class="cjk">，</span><code>xs</code> <span class="cjk">满足</span> <code>down</code><span class="cjk">，所以，这时不能再进行简单的递归，而要用</span> <code>tick</code> <span class="cjk">进行计算。</span></p><p><span class="cjk">继续以</span> <code>[2, 4, 3, 1]</code> <span class="cjk">为例。直觉上来讲，要求</span> <code>[2, 4, 3, 1]</code> <span class="cjk">的下一个枚举</span> <code>ys@(y:ys&#x27;)</code>,<!-- --> <span class="cjk">可以分为两步：</span></p><ul><li><span class="cjk">确定</span> <code>y</code> <span class="cjk">是什么</span></li><li><span class="cjk">确定</span> <code>ys&#x27;</code> <span class="cjk">是什么</span></li></ul><p><span class="cjk">首先，</span><code>y</code> <span class="cjk">要严格大于</span> <code>x</code>.<!-- --> <span class="cjk">因为我们已经表明，所有以</span> <code>x</code> <span class="cjk">开头的枚举都要比</span> <code>x:xs</code> <span class="cjk">小。其次，</span><code>y</code> <span class="cjk">要尽可能小，不然会有更小的枚举</span> <code>p</code> <span class="cjk">满足</span> <code>p &gt; x:xs</code>.</p><p><span class="cjk">上例中</span> <code>y</code> <span class="cjk">是</span> <code>3</code>.<!-- --> <span class="cjk">很容易想到，</span><code>3</code> <span class="cjk">是</span> <code>xs = [4, 3, 1]</code> <span class="cjk">中，</span><strong><span class="cjk">最小的</span></strong> <span class="cjk">大于</span> <code>x = 2</code> <span class="cjk">的数。我们把这种数叫做</span> <code>pivot</code>.<!-- --> <span class="cjk">可以写出定义代码：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">pivot</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">minumum</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span> </span><span class="token hvariable">x&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token hvariable">x&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&lt;-</span><span> </span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token hvariable">x&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">x</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">]</span></code></pre><p><span class="cjk">注意到</span> <code>xs</code> <span class="cjk">是有序的，以上代码可以改写为</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">pivot</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">last</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">takeWhile</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p><span class="cjk">需要指出的是，</span><code>pivot</code> <span class="cjk">函数是一个偏函数，我们用了不安全的</span> <code>last</code> <span class="cjk">和</span> <code>minimum</code> <span class="cjk">操作，这意味着在调用时，必须保证至少存在一个</span> <code>x&#x27; &gt; x</code>.</p><p><span class="cjk">如果能够找到这样的</span> <code>y &gt; x</code><span class="cjk">，那么我们就可以保证，</span><code>y:ys&#x27;</code> <span class="cjk">绝对比</span> <code>x:xs</code> <span class="cjk">大。所以，</span><code>ys&#x27;</code> <span class="cjk">的构造要使得</span> <code>y:ys&#x27;</code> <span class="cjk">尽可能小。也就是说，</span><code>ys&#x27;</code> <span class="cjk">应该是最小的一个排列。和我们上面对于最大值的讨论一样，最小的排列就是单调递增的排列。这只需要排序即可。</span></p><p><code>ys&#x27;</code> <span class="cjk">中的元素自然是</span> <code>xs</code> <span class="cjk">除掉</span> <code>y</code> <span class="cjk">之后，再加上</span> <code>x</code>.<!-- --> <span class="cjk">例如，上面的例子</span> <code>[2, 4, 3, 1]</code><span class="cjk">，可以给出</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token hvariable">y</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">last</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">takeWhile</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>  </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">last</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>  </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span></span><span class="token hvariable">ys&#x27;&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">delete</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>     </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span><span></span><span class="token hvariable">ys&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">sort</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">ys&#x27;&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">sort</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span><span></span><span class="token hvariable">ys</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">y</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">ys&#x27;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span><span>   </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span></code></pre><p><span class="cjk">最后，还需要讨论一种情况，那就是</span> <code>pivot x xs = ⊥</code>.<!-- --> <span class="cjk">这种情况必须先行判断，以免出现错误。什么时候</span> <code>pivot</code> <span class="cjk">不存在呢？那就是</span> <code>x:xs</code> <span class="cjk">已经满足</span> <code>down</code> <span class="cjk">的时候，例如</span> <code>[4, 3, 2, 1]</code><span class="cjk">，这种时候，只需要把输入反转即可。</span></p><p><span class="cjk">根据以上讨论，我们给出</span> <code>tick</code> <span class="cjk">函数的定义：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token import-statement" style="color:hsl(286, 60%, 67%)">import</span><span class="token import-statement"> Data</span><span class="token import-statement" style="color:hsl(220, 14%, 71%)">.</span><span class="token import-statement">List</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">delete</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token hvariable">tick</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">::</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">Ord</span><span> </span><span class="token hvariable">a</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token hvariable">a</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token hvariable">tick</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">null</span><span> </span><span class="token hvariable">l</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">reverse</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">otherwise</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">y</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">sort</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">ys&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">where</span><span> </span><span class="token hvariable">l</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">takeWhile</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>          </span><span class="token hvariable">y</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">last</span><span> </span><span class="token hvariable">l</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>          </span><span class="token hvariable">ys&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">delete</span><span> </span><span class="token hvariable">y</span><span> </span><span class="token hvariable">xs</span></code></pre><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">tick</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">tick</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span></code></pre><p><span class="cjk">毫无疑问，目前的</span> <code>next</code> <span class="cjk">函数已经能够正确地解决这个问题了。读者不妨把以上的</span> <!-- -->Haskell<!-- --> <span class="cjk">代码翻译为</span> <!-- -->Scala，在<!-- --> <!-- -->Leetcode<!-- --> <span class="cjk">里试一试。从递归出发，我们发现这个问题的解非常直觉，可以简单而轻松地给出。</span></p><h3 class="text-2xl" id="更高效的代码"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#更高效的代码">#</a><span class="cjk">更高效的代码</span></h3><p><span class="cjk">上面定义的</span> <code>next</code> <span class="cjk">函数虽然优雅直观，但是不够高效。主要的问题在于，</span></p><ol><li><code>tick</code> <span class="cjk">中，不需要用到</span> <code>sort</code>.<!-- --> <code>xs</code> <span class="cjk">是有序的，可以利用这点在</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> <span class="cjk">内把新的有序序列组合起来</span></li><li><code>down</code> <span class="cjk">被</span> <code>next</code> <span class="cjk">调用了好多次，每次调用都是</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> <span class="cjk">的，导致总体复杂度出现了</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.</li></ol><p><span class="cjk">问题</span> <!-- -->1.<!-- --> <span class="cjk">很简单，只需要重新写一下</span> <code>tick</code> <span class="cjk">即可。</span></p><p><span class="cjk">问题</span> <!-- -->2.<!-- --> <span class="cjk">比较麻烦。我们需要仔细观查一下计算的过程，例如</span> <code>next [3, 5, 1, 4, 2]</code><span class="cjk">：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">next</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">next</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">next</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">tick</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><p><span class="cjk">可以看到，这个计算总是会具有一种</span> <q><span class="cjk">形状</span></q><span class="cjk">，那就是输入的前一部分保持不变，后一部分被</span> <code>tick</code>.</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>           </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(207, 82%, 66%)">^^^^^^</span><span>           </span><span class="token" style="color:hsl(207, 82%, 66%)">#######</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>保持不变的部分     </span><span class="token hvariable">tick</span><span> 的部分</span></code></pre><p><span class="cjk">而它们的分界线，直觉上来讲，就是</span> <code>down</code> <span class="cjk">由</span> <code>False</code> <span class="cjk">变为</span> <code>True</code> <span class="cjk">的时刻。我们再回到</span> <code>next</code> <span class="cjk">函数：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">next</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token hvariable">down</span><span> </span><span class="token hvariable">xs</span><span>  </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">tick</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">otherwise</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">next</span><span> </span><span class="token hvariable">xs</span></code></pre><p><span class="cjk">在每次递归的时候，</span><code>next (x:xs)</code> <span class="cjk">都会计算</span> <code>down xs</code><span class="cjk">，再用刚才的例子，</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">-- 第一次递归</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">False</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">-- 第二次递归</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">False</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span></span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">-- 第三次递归</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span></span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>       </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span></code></pre><p><span class="cjk">事实上，</span><code>down</code> <span class="cjk">每次都顺序地计算</span> <code>tails</code> <span class="cjk">里的下一个元素：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">tails</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">5</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span></code></pre><p><span class="cjk">不妨把</span> <code>next</code> <span class="cjk">每次用到的</span> <code>down xs</code> <span class="cjk">提前</span><sup><a href="#note-2" id="note-anchor-2">2</a></sup><span class="cjk">算出来，并放到一个列表里</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token import-statement" style="color:hsl(286, 60%, 67%)">import</span><span class="token import-statement"> Data</span><span class="token import-statement" style="color:hsl(220, 14%, 71%)">.</span><span class="token import-statement">List</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">tails</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token hvariable">nextDown</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">d</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">ds</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token hvariable">d</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">tick</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">otherwise</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">nextDown</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token hvariable">ds</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span></span><span class="token hvariable">next</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">nextDown</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">downs</span><span> </span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span></span><span class="token hvariable">downs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails</span></code></pre><p><span class="cjk">如果我们可以在</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> <span class="cjk">时间内算出</span> <code>downs</code><span class="cjk">，问题</span> <!-- -->2.<!-- --> <span class="cjk">就迎刃而解了。直觉上来说，这是很容易的，因为</span> <code>down [4, 3, 2, 1]</code> <span class="cjk">本来就是要保证：</span></p><ul><li><code>4 &gt;= 3</code></li><li><code>down [3, 2, 1]</code></li></ul><p><span class="cjk">换句话说，当我们要算</span> <code>down [4, 3, 2, 1]</code> <span class="cjk">的时候，</span><code>down [3, 2, 1]</code> <span class="cjk">已经被计算过了，只是需要一种方式把这种</span> <q><span class="cjk">上一次的计算</span></q> <span class="cjk">存起来以便后续使用。</span></p><p><span class="cjk">函数式编程社区早就有了对于这种问题的解决方法：</span> <!-- -->scan<!-- --> <!-- -->theorem.</p><p>Scan<!-- --> <!-- -->theorem<!-- --> <span class="cjk">指的是</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">foldl</span><span> </span><span class="token hvariable">op</span><span> </span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">inits</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">scanl</span><span> </span><span class="token hvariable">op</span><span> </span><span class="token hvariable">a</span></code></pre><p><span class="cjk">类似地</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">foldr</span><span> </span><span class="token hvariable">op</span><span> </span><span class="token hvariable">a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">scanr</span><span> </span><span class="token hvariable">op</span><span> </span><span class="token hvariable">a</span></code></pre><p>利用这个定理，我们给出以下程序计算过程.<!-- --> <span class="cjk">注意，为了避免问题，我们定义了</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">tails&#x27;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">filter</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">not</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">null</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails</span></code></pre><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">downs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token hvariable">definition</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token hvariable">down</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails&#x27;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token hvariable">definition</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">all</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">uncurry</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails&#x27;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token hvariable">distributivity</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">all</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">uncurry</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token hvariable">dup</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails&#x27;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token hvariable">need</span><span> </span><span class="token hvariable">another</span><span> </span><span class="token hvariable">proof</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">all</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">uncurry</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token hvariable">definition</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">foldr</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">uncurry</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token hvariable">fold</span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token hvariable">fusion</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">foldr</span><span> </span><span class="token hvariable">join</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">tails</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token hvariable">scan</span><span> </span><span class="token hvariable">theorem</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">drop</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">scanr</span><span> </span><span class="token hvariable">join</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span><span>          </span><span class="token" style="color:hsl(286, 60%, 67%)">where</span><span> </span><span class="token hvariable">join</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token hvariable">x1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token hvariable">r</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span> </span><span class="token hvariable">x1</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span> </span><span class="token hvariable">r</span></code></pre><ol><li><span class="cjk">需要一个新的证明，它指的是下面的代码是等价的：</span></li></ol><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">map</span><span> </span><span class="token hvariable">dup</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span> </span><span class="token hvariable">tails&#x27;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span></span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">tails</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span> </span><span class="token hvariable">dup</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">4</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">3</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span></code></pre><p><span class="cjk">证明略去。</span></p><h3 class="text-2xl" id="总结"><a color="secondary" class="pr-3 no-underline hover:underline text-primary font-sans" href="#总结">#</a><span class="cjk">总结</span></h3><p><span class="cjk">结合上面的讨论，我们可以给出高效的函数式实现：</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-haskell" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token hvariable">tick</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">build</span><span> </span><span class="token hvariable">l</span><span> </span><span class="token hvariable">r</span><span> </span><span class="token hvariable">x</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">where</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">l</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">span</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>          </span><span class="token hvariable">build</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token hvariable">r</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">reverse</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>          </span><span class="token hvariable">build</span><span> </span><span class="token hvariable">l</span><span>  </span><span class="token hvariable">r</span><span> </span><span class="token hvariable">x</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">last</span><span> </span><span class="token hvariable">l</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">reverse</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">init</span><span> </span><span class="token hvariable">l</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> </span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span></span><span class="token hvariable">dup</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">zip</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">tail</span><span> </span><span class="token hvariable">xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span></span><span class="token hvariable">downs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">scanr</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">\</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token hvariable">x1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token hvariable">r</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">x</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span> </span><span class="token hvariable">x1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span> </span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">True</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">.</span><span> </span><span class="token hvariable">dup</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span></span><span class="token hvariable">next</span><span> </span><span class="token hvariable">xs</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token hvariable">l</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> </span><span class="token hvariable">tick</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">head</span><span> </span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">tail</span><span> </span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">where</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">l</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token hvariable">r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">splitAt</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token hvariable">n</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token hvariable">xs</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span>          </span><span class="token hvariable">n</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">length</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">takeWhile</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">not</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">$</span><span> </span><span class="token hvariable">downs</span><span> </span><span class="token hvariable">xs</span></code></pre><p><span class="cjk">这是</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> <span class="cjk">时间复杂度的。不过，我们的常数确实会比命令式程序大些。理论上来说，上一节定义的</span> <code>nextDown</code> <span class="cjk">函数的实现要更高效一些（避免了</span> <code>length</code> <span class="cjk">和</span> <code>splitAt</code><span class="cjk">），但是我仍然觉得本节给出的实现更清楚。</span></p><p><span class="cjk">我把等价的</span> <!-- -->Scala<!-- --> <span class="cjk">代码提交到了</span> <!-- -->leetcode:</p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-scala" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(286, 60%, 67%)">object</span><span> Solution </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> nextPermutation</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>nums</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> Array</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">Unit</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">val</span><span> nextNums </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> next</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>nums</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>toList</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>toArray
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>i </span><span class="token" style="color:hsl(286, 60%, 67%)">&lt;-</span><span> nums</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>indices</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>            nums</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>i</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> nextNums</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>i</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span>        </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> dup</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>xs</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> xs zip xs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>drop</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> tick</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>x</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> xs</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">val</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>l</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> xs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>span</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>_ </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>l</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>isEmpty</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> r</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>reverse </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">else</span><span> l</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>last </span><span class="token" style="color:hsl(207, 82%, 66%)">::</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>l</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>init </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>x</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>reverse
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">16</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">17</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> tailsDown</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>xs</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Boolean</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">18</span><span>        xs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>scanRight</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">true</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">case</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>x</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> x1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">=&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>x </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span> x1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span> r </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">19</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">20</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> next</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>xs</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> List</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(95, 38%, 62%)">Int</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">21</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">val</span><span> n </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tailsDown</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>dup</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>xs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>takeWhile</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">!</span><span>_</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>length
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">22</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">val</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>l</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> r</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> xs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>splitAt</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>n </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">23</span><span>        l </span><span class="token" style="color:hsl(207, 82%, 66%)">++</span><span> tick</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>r</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>head</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> r</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>tail</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">24</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">25</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span></code></pre><p><q><span class="cjk">下一个排列</span></q> <!-- -->问题是少有的命令式程序可以比函数式程序简洁的问题。甚至，Haskell<!-- --> <span class="cjk">的</span> <a href="https://hackage.haskell.org/package/permutation-0.5.0.5/docs/Data-Permute.html">Data.Permute</a> <span class="cjk">库，也用了命令式的方法。</span></p><p><span class="cjk">在命令式程序中，上面的算法可以被描述为两个过程：</span></p><ol><li><span class="cjk">从右向左遍历，找到最长的下降序列</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>…</mo><mo stretchy="false">(</mo><mtext>len - 1</mtext><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i \dots (\text{len - 1})]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">len - 1</span></span><span class="mclose">)]</span></span></span></span></span></li><li><span class="cjk">进行计算，</span><ul><li><p><span class="cjk">如果</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">i = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="cjk">，那么反转数组</span></p></li><li><p><span class="cjk">其他情况，找到</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>∈</mo><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mtext>(len - 1)</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">j \in [i, \text{(len - 1)}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">(len - 1)</span></span><span class="mclose">]</span></span></span></span></span><span class="cjk">，使得</span></p><ul><li><span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[j] &gt; a[i - 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></li><li><span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>k</mi><mo>≥</mo><mi>i</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>→</mo><mi>a</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo>≥</mo><mi>a</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\forall k \ge i, a[k] &gt; a[i - 1] \to a[k] \ge a[j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span></span></li></ul><p><span class="cjk">交换</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i - 1, j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="cjk">，反转</span> <span data-testid="react-katex"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>…</mo><mo stretchy="false">(</mo><mtext>len - 1</mtext><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i \dots (\text{len - 1})]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">len - 1</span></span><span class="mclose">)]</span></span></span></span></span></p></li></ul></li></ol><p><span class="cjk">如果读者完全理解了上面的函数式算法，这个命令式算法想必是非常直白的。但如果把这个算法直接端到你的面前喂给你，你真的能明白它为什么是正确的吗？</span></p><p><span class="cjk">让我们用一个</span> <!-- -->Python<!-- --> <span class="cjk">程序结束今天的故事吧！</span></p><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-python" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">swap</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> i</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> j</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span>    tmp </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>i</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span>    a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>i</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>j</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span><span>    a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>j</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> tmp
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">rev</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> start</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> end</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span>    l </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> end </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> start
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> i </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">range</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>start</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> start </span><span class="token" style="color:hsl(207, 82%, 66%)">+</span><span> l </span><span class="token" style="color:hsl(207, 82%, 66%)">//</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">2</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>        swap</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> i</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> end </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>i </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> start</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">def</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">solve</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">for</span><span> i </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">range</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">len</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> i </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>i </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&lt;</span><span> a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>i</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span><span>            </span><span class="token" style="color:hsl(286, 60%, 67%)">break</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> i </span><span class="token" style="color:hsl(207, 82%, 66%)">==</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">16</span><span>        rev</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">len</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">17</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">else</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">18</span><span>        j </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">len</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">19</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">while</span><span> j </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;=</span><span> i </span><span class="token" style="color:hsl(286, 60%, 67%)">and</span><span> a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>j</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&lt;=</span><span> a</span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>i </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">20</span><span>            j </span><span class="token" style="color:hsl(207, 82%, 66%)">-=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">21</span><span>        swap</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> i </span><span class="token" style="color:hsl(207, 82%, 66%)">-</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">1</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> j</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">22</span><span>        rev</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> i</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">len</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>a</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span></code></pre><div class="notes"></div></article></div></div></div></div><script src="/_next/static/chunks/webpack-f70da49b2a689e16.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/57e8d276a38ab64c.css\",\"style\"]\n2:HL[\"/_next/static/css/ad2762ca96cee671.css\",\"style\"]\n3:HL[\"/_next/static/css/97d548e729a05adf.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[89562,[],\"\"]\n7:I[78703,[],\"\"]\na:I[53751,[],\"\"]\nb:I[59576,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"Providers\"]\ne:I[51395,[],\"\"]\n8:[\"locale\",\"zh-cn\",\"d\"]\n9:[\"slug\",\"fp-lc100-001-permutation\",\"d\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[null,[\"$\",\"$L4\",null,{\"buildId\":\"nXt9FzmIDfEVB2NU5Aav0\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/zh-cn/posts/fp-lc100-001-permutation\",\"initialTree\":[\"\",{\"children\":[[\"locale\",\"zh-cn\",\"d\"],{\"children\":[\"posts\",{\"children\":[[\"slug\",\"fp-lc100-001-permutation\",\"d\"],{\"children\":[\"__PAGE__?{\\\"locale\\\":\\\"zh-cn\\\",\\\"slug\\\":\\\"fp-lc100-001-permutation\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"locale\",\"zh-cn\",\"d\"],{\"children\":[\"posts\",{\"children\":[[\"slug\",\"fp-lc100-001-permutation\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\"],null],null]},[[\"$\",\"div\",null,{\"className\":\" relative w-full py-12 shadow-xl shadow-slate-700/20 ring-1 ring-gray-900/5 dark:shadow-slate-100/20 dark:ring-gray-100/5 lg:mx-auto lg:max-w-4xl lg:pt-16 lg:pb-28 bg-lightwhite dark:bg-lightblack\",\"children\":[\"$\",\"div\",null,{\"className\":\"prose prose-natural dark:prose-invert mx-auto max-w-full px-8 sm:px-16 relative\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\",\"posts\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97d548e729a05adf.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}]}]}],null],null]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"zh-cn\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"text-foreground bg-background min-h-screen\",\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$Lc\",[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]}]}]}],null],null]},[[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/57e8d276a38ab64c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ad2762ca96cee671.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"Navbar\"]\n11:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"NavbarBrand\"]\n13:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"NavbarItem\"]\n16:I[53693,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"NavbarContent\"]\n17:I[81946,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"default\"]\n18:I[48125,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"default\"]\nc:[\"$\",\"$L10\",null,{\"shouldHideOnScroll\":true,\"children\":[[\"$\",\"$L11\",null,{\"className\":\"flex flex-row gap-4\",\"children\":[[\"$\",\"p\",null,{\"className\":\"font-bold text-inherit\",\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{\"children\":\"$L14\"}],[\"$\",\"$L13\",null,{\"children\":\"$L15\"}]]}],[\"$\",\"$L16\",null,{\"justify\":\"end\",\"className\":\"gap-1\",\"children\":[[\"$\",\"$L13\",null,{\"children\":[\"$\",\"$L17\",null,{}]}],["])</script><script>self.__next_f.push([1,"\"$\",\"$L13\",null,{\"children\":[\"$\",\"$L18\",null,{}]}]]}]]}]\nd:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Aya's Blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A site powered by next.js and pandoc\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}]]\n5:null\n"])</script><script>self.__next_f.push([1,"19:I[9678,[\"706\",\"static/chunks/706-97ed238ee5a03fb5.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"911\",\"static/chunks/911-e9f556f9b03e931c.js\",\"373\",\"static/chunks/373-fbdb9516436dc720.js\",\"203\",\"static/chunks/app/%5Blocale%5D/layout-3df2a5079cf0a3bb.js\"],\"default\"]\n12:[\"$\",\"$L19\",null,{\"locale\":\"zh-cn\",\"localePrefix\":\"always\",\"href\":\"/\",\"aria-label\":\"主页\",\"children\":\"主页\"}]\n14:[\"$\",\"$L19\",null,{\"locale\":\"zh-cn\",\"localePrefix\":\"always\",\"href\":\"/blog/\",\"className\":\"font-bold\",\"aria-label\":\"博客\",\"children\":\"博客\"}]\n15:[\"$\",\"$L19\",null,{\"locale\":\"zh-cn\",\"localePrefix\":\"always\",\"href\":\"/favorites/\",\"className\":\"font-bold\",\"aria-label\":\"园地\",\"children\":\"园地\"}]\n"])</script><script>self.__next_f.push([1,"1a:\"$Sreact.fragment\"\n1b:I[75164,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"306\",\"static/chunks/306-ef157ce75cbf9e7a.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-8ab52a4fba20768e.js\"],\"default\"]\n1c:I[65469,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"306\",\"static/chunks/306-ef157ce75cbf9e7a.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-8ab52a4fba20768e.js\"],\"\"]\n1f:I[39926,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"306\",\"static/chunks/306-ef157ce75cbf9e7a.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-8ab52a4fba20768e.js\"],\"default\"]\n23:I[27377,[\"645\",\"static/chunks/61af6f7f-9cff01d0fc100f98.js\",\"469\",\"static/chunks/469-7ee2e4c850f58403.js\",\"306\",\"static/chunks/306-ef157ce75cbf9e7a.js\",\"827\",\"static/chunks/app/%5Blocale%5D/posts/%5Bslug%5D/page-8ab52a4fba20768e.js\"],\"default\"]\n1d:T1199,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003enext\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e{\u003c/mo\u003e\u003cmtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmrow\u003e\u003cmi\u003emin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"double-struck\"\u003eP\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmrow\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003emax\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"double-struck\"\u003eP\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmrow\u003e\u003cmi\u003emin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e{\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo\u003e∈\u003c/mo\u003e\u003cmi mathvariant=\"double-struck\"\u003eP\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e}\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmtext\u003eotherwise\u003c/mtext\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003c/mrow\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\n\\text{next}(a) = \\begin{cases}\n  \\min(\\mathbb{P}) \u0026amp; a = \\max(\\mathbb{P}) \\\\\n  \\min(\\{ m | m \\in \\mathbb{P}, m \u0026gt; a \\}) \u0026amp; \\text{otherwise}\n\\end{cases}\n\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003enext\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size4\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-l\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.69em;\"\u003e\u003cspan style=\"top:-3.69em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.008em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mop\"\u003emin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbb\"\u003eP\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.25em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.008em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mop\"\u003emin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e({\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e∈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbb\"\u003eP\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mclose\"\u003e})\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.19em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"col-align-l\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.69em;\"\u003e\u003cspan style=\"top:-3.69em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.008em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003emax\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbb\"\u003eP\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.25em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.008em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eotherwise\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.19em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"1e:T49d,\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef(x) = x + 1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e20:T442,\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e∈\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmtext\u003e(len - 1)\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej \\in [i, \\text{(len - 1)}]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e∈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan"])</script><script>self.__next_f.push([1," class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003e(len - 1)\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e21:T557,\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ea[j] \u0026gt; a[i - 1]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e22:Tb8c,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∀\u003c/mi\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo\u003e≥\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003cmo\u003e\u0026gt;\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003cmo\u003e→\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003cmo\u003e≥\u003c/mo\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\forall k \\ge i, a[k] \u0026gt; a[i - 1] \\to a[k] \\ge a[j]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∀\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≥\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e→\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≥\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"6:[\"$\",\"div\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold mb-2\",\"children\":\"函数式 Leetcode 百题 – 排列\"}],[\"$\",\"div\",null,{\"className\":\"text-sm text-gray-500 mb-5\",\"children\":\"4/24/2024\"}],[\"$\",\"$1a\",\"0\",{\"children\":[[\"$\",\"$L1b\",null,{\"children\":[[\"$\",\"ul\",\"0\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#前言\",\"id\":\"toc-前言\",\"children\":[\"前言\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#下一个排列\",\"id\":\"toc-下一个排列\",\"children\":[\"31.\",\" \",\"下一个排列\"]}],[\"$\",\"ul\",\"1\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#题目描述\",\"id\":\"toc-题目描述\",\"children\":[\"题目描述\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#第一想法\",\"id\":\"toc-第一想法\",\"children\":[\"第一想法\"]}]]}],[\"$\",\"li\",\"2\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#递归\",\"id\":\"toc-递归\",\"children\":[\"递归\"]}]]}],[\"$\",\"li\",\"3\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#ismax-的定义\",\"id\":\"toc-ismax-的定义\",\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"isMax\"]}],\" \",\"的定义\"]}]]}],[\"$\",\"li\",\"4\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#tick-的定义\",\"id\":\"toc-tick-的定义\",\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"tick\"]}],\" \",\"的定义\"]}]]}],[\"$\",\"li\",\"5\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#更高效的代码\",\"id\":\"toc-更高效的代码\",\"children\":[\"更高效的代码\"]}]]}],[\"$\",\"li\",\"6\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#总结\",\"id\":\"toc-总结\",\"children\":[\"总结\"]}]]}]]}]]}]]}]]}],[\"$\",\"article\",\"1\",{\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-3xl\",\"id\":\"前言\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#前言\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"前言\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"算法题，是很多程序员的梦魇之一。算法本身当然是有趣的，但不会做题的抓狂、面试回答不出问题的窘迫，没有人会喜欢。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"应对算法题挑战的传统方式是\"]}],\" \",[\"$\",\"strong\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"刷题\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"。\"]}],[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"刷题，也就是做大量的题目来学习算法。很多人笃信一种理论，无论是数学学习还是算法学习，都必须进行大量的练习。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我也认同这种理论。冯诺依曼的箴言还挂在本博客的首页上：\"]}]]}],[\"$\",\"blockquote\",\"4\",{\"children\":[[\"$\",\"p\",null,{\"children\":[\"Young\",\" \",\"man,\",\" \",\"in\",\" \",\"mathematics\",\" \",\"you\",\" \",\"don’t\",\" \",\"understand\",\" \",\"things.\",\" \",\"You\",\" \",\"just\",\" \",\"get\",\" \",\"used\",\" \",\"to\",\" \",\"them.\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"直觉的认识，直觉的经验，是无比宝贵的财富。练习是获取这种宝贵财富最可靠的手段。简而言之，想要学习算法，你必须刷题，必须练习。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"然而，我确实极度厌烦一种算法学习的常规路径。那就是看到某道题不会做，思考了\"]}],\" \",\"10\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"分钟还是不知道从何入手，那么就去寻找答案。也许你\"]}],\" \",[\"$\",\"q\",\"2\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"理解\"]}]]}],\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"了答案或者记住了答案，下次看到相同的题目的时候就套进去。只要你见过的答案够多，那么你能\"]}],\" \",[\"$\",\"q\",\"4\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"套\"]}]]}],\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"的题目也够多。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"为什么我不喜欢这种学习方法呢？也许是我不够聪明吧，我很难\"]}],\" \",[\"$\",\"q\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"理解\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"别人给的答案。太多的人只是把最后的高效算法告诉你，而忽略了直觉建立的过程，更别提算法的证明了。从这些人的答案里，我既没有感受到他们对于问题的深刻理解，又没有感受到算法本身的美感。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"难道我们只能通过给\"]}],\" \",[\"$\",\"q\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"天才\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"设计的教育来学习算法吗？\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"不。世界上还有一群人，在尝试着用纯函数式的语言，用等式推导的方法来设计程序。这些人同样也珍视直觉的价值。他们会从一个清晰而不高效的程序出发，一步步地给出最终的高效算法。在这个过程中，算法的美、算法的\"]}],\" \",\"insight\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"纤毫毕现。已故的\"]}],\" \",\"Richard\",\" \",\"Bird，台湾的穆信成老师都是这种方式的先驱。在他们的论文和书籍中，我感受到了一种真正的温柔。\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我想，虽然等式推导很多时候非常困难，但是把算法的\"]}],\" \",\"non-trivial\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"之处是什么、算法的直觉是什么讲清楚，也许没有那么困难。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"本系列文章就是我的尝试。我将在这些文章中，讲解我是怎么用纯函数式编程解决\"]}],\" \",\"Leetcode\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"的。至于为什么选择\"]}],\" \",\"Leetcode\",\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"而不是难度更高的\"]}],\" \",\"Codeforces，我认为难度太高，也许不是好事。高难度的问题很可能需要多个算法共同来处理，而我们更想在每篇文章中关注某类具体的算法。（另一个原因是，我本人对于算法仍然是某种意义的\",\" \",[\"$\",\"q\",\"3\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"初学者\"]}]]}],[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"，难度太高我也处理不来）\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"选择\"]}],\" \",\"Leetcode\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"的一个后果是，我们必须用\"]}],\" \",\"Racket\",\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"或者\"]}],\" \",\"Scala\",\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"而非\"]}],\" \",\"Haskell\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"来提交代码。这有时候会造成一些困扰，不过我的经验是，大部分我给出的\"]}],\" \",\"Haskell\",\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"代码可以直接翻译到\"]}],\" \",\"Scala\",\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"上。每道题目我也会给出对应的\"]}],\" \",\"Scala\",\" \",[\"$\",\"span\",\"7\",{\"className\":\"cjk\",\"children\":[\"解。如果确实有问题，比如\"]}],\" \",\"Scala\",\" \",[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"没有\"]}],\" \",[\"$\",\"code\",\"9\",{\"children\":[\"Data.Graph\"]}],\" \",[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"这种不可变数据结构库，那么我们会视情况退回到非纯函数式编程。不过，这种情况总体应该是较少的。在每道题目的最后，我可能也会把对应的命令式版本给出，也许我们还会探讨一下函数式版本和命令式版本的区别。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"这些文章不是\"]}],\" \",[\"$\",\"q\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"函数式编程入门\"]}]]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"。虽然我也许会提示某个库函数的用法，但是总体来说，这些文章假设你已经有了纯函数式编程的基本知识\"]}],\" \",\"–\",\" \",\"递归，列表，fold，map\",\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"等等。如果你对函数式编程和\"]}],\" \",\"Haskell\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"语言一无所知，那么在阅读这些文章之前最好简单学习一些\"]}],\" \",\"Haskell\",\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"知识。以下是我比较推荐的学习资源：\"]}]]}],[\"$\",\"ul\",\"14\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"https://www.seas.upenn.edu/~cis1940/spring13/lectures.html\",\"children\":[\"cis194\",\" \",[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"课程\"]}]]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"em\",\"0\",{\"children\":[\"Thinking\",\" \",\"Functionally\",\" \",\"With\",\" \",\"Haskell\"]}],[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"，以及其中文翻译版本\"]}],\" \",[\"$\",\"a\",\"2\",{\"href\":\"https://book.douban.com/subject/26769112/\",\"children\":[\"Haskell函数式程序设计\"]}]]}],[\"$\",\"li\",\"2\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"练习是重要的，可以通过\"]}],\" \",[\"$\",\"a\",\"1\",{\"href\":\"https://wiki.haskell.org/99_questions/1_to_10\",\"children\":[\"Haskell\",\" \",\"99\",\" \",[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"题\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"进行练习。这些练习和\"]}],\" \",\"Leetcode\",\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"不同，大部分通过直接的递归就可以完成\"]}]]}]]}],[\"$\",\"blockquote\",\"15\",{\"children\":[[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"路漫漫其修远兮，吾将上下而求索\"]}]]}]]}],[\"$\",\"h2\",null,{\"className\":\"text-3xl\",\"id\":\"下一个排列\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#下一个排列\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[\"31.\",\" \",[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"下一个排列\"]}]]]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"题目描述\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#题目描述\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"题目描述\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"以下是\"]}],\" \",[\"$\",\"a\",\"1\",{\"href\":\"https://leetcode.cn/problems/next-permutation/\",\"children\":[\"Leetcode\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"的原始描述：\"]}]]}],[\"$\",\"blockquote\",\"19\",{\"children\":[[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"整数数组的一个\"]}],\" \",[\"$\",\"strong\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"排列\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"就是将其所有成员以序列或线性顺序排列。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"例如，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"arr = [1,2,3]\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，以下这些都可以视作\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"arr\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"的排列：\"]}],[\"$\",\"code\",\"5\",{\"children\":[\"[1,2,3]\"]}],[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"、\"]}],[\"$\",\"code\",\"7\",{\"children\":[\"[1,3,2]\"]}],\"、`\",[\"$\",\"code\",\"8\",{\"children\":[\"[3,1,2]\"]}],[\"$\",\"span\",\"9\",{\"className\":\"cjk\",\"children\":[\"、\"]}],[\"$\",\"code\",\"10\",{\"children\":[\"[2,3,1]\"]}],\" \",[\"$\",\"span\",\"11\",{\"className\":\"cjk\",\"children\":[\"。\"]}],[\"$\",\"span\",\"12\",{\"className\":\"cjk\",\"children\":[\"整数数组的\"]}],\" \",[\"$\",\"span\",\"13\",{\"className\":\"cjk\",\"children\":[\"下一个排列\"]}],[\"$\",\"span\",\"14\",{\"className\":\"cjk\",\"children\":[\"是指其整数的下一个字典序更大的排列。更正式地，如果数组的所有排列根据其字典顺序从小到大排列在一个容器中，那么数组的\"]}],\" \",[\"$\",\"span\",\"15\",{\"className\":\"cjk\",\"children\":[\"下一个排列\"]}],[\"$\",\"span\",\"16\",{\"className\":\"cjk\",\"children\":[\"就是在这个有序容器中排在它后面的那个排列。如果不存在下一个更大的排列，那么这个数组必须重排为字典序最小的排列（即，其元素按升序排列）。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"例如，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"arr = [1,2,3]\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"的下一个排列是\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"[1,3,2]\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"。\"]}],[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"类似地，\"]}],[\"$\",\"code\",\"6\",{\"children\":[\"arr = [2,3,1]\"]}],\" \",[\"$\",\"span\",\"7\",{\"className\":\"cjk\",\"children\":[\"的下一个排列是\"]}],\" \",[\"$\",\"code\",\"8\",{\"children\":[\"[3,1,2]\"]}],\" \",[\"$\",\"span\",\"9\",{\"className\":\"cjk\",\"children\":[\"。\"]}],[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"而\"]}],\" \",[\"$\",\"code\",\"11\",{\"children\":[\"arr = [3,2,1]\"]}],\" \",[\"$\",\"span\",\"12\",{\"className\":\"cjk\",\"children\":[\"的下一个排列是\"]}],\" \",[\"$\",\"code\",\"13\",{\"children\":[\"[1,2,3]\"]}],\" \",[\"$\",\"span\",\"14\",{\"className\":\"cjk\",\"children\":[\"，因为\"]}],\" \",[\"$\",\"code\",\"15\",{\"children\":[\"[3,2,1]\"]}],\" \",[\"$\",\"span\",\"16\",{\"className\":\"cjk\",\"children\":[\"不存在一个字典序更大的排列。\"]}],[\"$\",\"span\",\"17\",{\"className\":\"cjk\",\"children\":[\"给你一个整数数组\"]}],\" \",[\"$\",\"code\",\"18\",{\"children\":[\"nums\"]}],\" \",[\"$\",\"span\",\"19\",{\"className\":\"cjk\",\"children\":[\"，找出\"]}],\" \",[\"$\",\"code\",\"20\",{\"children\":[\"nums\"]}],\" \",[\"$\",\"span\",\"21\",{\"className\":\"cjk\",\"children\":[\"的下一个排列。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"必须\"]}],[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"原地\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"修改，只允许使用额外常数空间。\"]}]]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我们是在纯函数式编程。纯函数式编程没有所谓的\"]}],\" \",[\"$\",\"q\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"修改\"]}]]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，所以最后一句话我们无视即可。\"]}]]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"第一想法\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#第一想法\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"第一想法\"]}]]]}],[\"$\",\"p\",null,{\"children\":[\"一般来说，很多算法问题能够给一个极为简洁（但低效）的纯函数式解。我们把这个解称之为程序的标准参照（Spec），我们的思考也从这里出发。然而，这个问题却似乎不是这种情况。考虑这个问题的数学表达：\"]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[\"$\",\"div\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"$1d\"}}]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"这没有给我们多少灵感。事实上，在很多编程语言里，把\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\\\"double-struck\\\"\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003e\\\\mathbb{P}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:0.6889em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathbb\\\"\u003eP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，也就是某个列表的所有排列求出来，比这个问题还要麻烦。\"]}],[\"$\",\"sup\",\"3\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#note-1\",\"id\":\"note-anchor-1\",\"children\":[\"1\"]}]]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"这种情况下，一个直觉的尝试是，\"]}],[\"$\",\"strong\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"简单的递归\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"能不能解决问题呢？\"]}]]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"递归\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#递归\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"递归\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"下一个排列函数（记为\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next\"]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"）虽然定义在排列和字典序上，但却显然可以被推广到更泛化的结构上。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我们首先考查十进制整数的情况。显然地，十进制整数也可以定义\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"函数。这就是大名鼎鼎的\"]}],\" \",[\"$\",\"q\",\"3\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"后继\"]}]]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"函数，即\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"$1e\"}}],\" \",\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"十进制整数可以被表示为一个列表（或者，命令式语言里的数组），列表中的每个元素表示数字的每一位。例如，\"]}],[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e100\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003e100\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord\\\"\u003e100\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"被表示为\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"[1, 0, 0]\"]}],\" \",\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我们特别关心列表表示下的后继函数，因为在这种表示下，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"\u003e=\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"恰恰就是字典序比较。我们把列表表示下，十进制整数的后继函数记作\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"next10\"]}],\".\"]}],[\"$\",\"$L1f\",\"31\",{\"className\":\"haskell\",\"children\":[\"-- next10 [1, 1, 0] = [1, 1, 1]\\nnext10 ...\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"例如，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"next10 [1, 1, 0] = [1, 1, 1]\"]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"这个例子给了我们非常强的直觉。那就是\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next10 [1, 0] = [1, 1]\"]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，此时\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"next10 [1, 1, 0] = 1 : next10 [1, 0]\"]}],\".\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"把这种关系一般化，我们得到对于\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"x:xs\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"表示的整数，\"]}]]}],[\"$\",\"$L1f\",\"34\",{\"className\":\"haskell\",\"children\":[\"next10 (x:xs) = x:(next10 xs)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"上式在大部分时候都成立。除非，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"next10 xs\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"已经\"]}],\" \",[\"$\",\"q\",\"3\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"求不出来了\"]}]]}],[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"，比如\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"[1, 9, 9]\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"的下一个数字（后继）是\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"[2, 0, 0]\"]}],[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"，这时就必须要\"]}],\" \",[\"$\",\"q\",\"9\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"进位\"]}]]}],[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"。更严格地说，\"]}],[\"$\",\"code\",\"11\",{\"children\":[\"99\"]}],\" \",[\"$\",\"span\",\"12\",{\"className\":\"cjk\",\"children\":[\"是\"]}],\" \",[\"$\",\"strong\",\"13\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"最大\"]}]]}],\" \",[\"$\",\"span\",\"14\",{\"className\":\"cjk\",\"children\":[\"的两位十进制整数，所以上式不成立。可以证明，只要\"]}],\" \",[\"$\",\"code\",\"15\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"16\",{\"className\":\"cjk\",\"children\":[\"还不是最大值，那么上面的等式就成立。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"类似地，同样可以证明题目要求的\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"函数具有同样的性质：当\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"不是长度为\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"length xs\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"的排列的最大值时，\"]}]]}],[\"$\",\"$L1f\",\"37\",{\"className\":\"haskell\",\"children\":[\"next (x:xs) = x:next xs\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"这个性质实在太过重要，因为我们可以直接构造递归函数：\"]}]]}],[\"$\",\"$L1f\",\"39\",{\"className\":\"haskell\",\"children\":[\"next (x:xs)\\n    | isMax xs  = tick x xs\\n    | otherwise = x:next xs\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"那么，问题就变成了\"]}]]}],[\"$\",\"ol\",\"41\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如何定义\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"isMax\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如果\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"已经是最大值了，那么\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"tick\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"函数该怎么定义呢？\"]}]]}]]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"ismax-的定义\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#ismax-的定义\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"code\",\"0\",{\"children\":[\"isMax\"]}],\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"的定义\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"对于一个排列\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"来说，\"]}],[\"$\",\"q\",\"3\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"最大\"]}]]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"就是说，无论怎么重新排列，新的\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"xs'\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"一定有\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"xs \u003e= xs'\"]}],\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"什么样的排列具有这种性质呢？一个很自然的想法是，因为这是字典序，所以如果想要排列尽可能大，那就一定要把大的数放在前面。换句话说，\"]}],[\"$\",\"q\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"降序\"]}]]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"的排列一定是最大的。\"]}]]}],[\"$\",\"$L1f\",\"45\",{\"className\":\"haskell\",\"children\":[\"isMax :: Ord a =\u003e [a] -\u003e Bool\\nisMax = down\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"在\"]}],\" \",\"Haskell\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"里，判断一个列表的升降，我们可以使用\"]}],\" \",[\"$\",\"q\",\"2\",{\"children\":[\"zip\",\" \",\"with\",\" \",\"tail\"]}],\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"的方法。具体来说，就是首先把列表和它的\"]}],\" \",[\"$\",\"code\",\"4\",{\"children\":[\"tail\"]}],\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"进行\"]}],\" \",[\"$\",\"code\",\"6\",{\"children\":[\"zip\"]}],[\"$\",\"span\",\"7\",{\"className\":\"cjk\",\"children\":[\"，然后再使用\"]}],\" \",[\"$\",\"code\",\"8\",{\"children\":[\"map\"]}],\",\",\" \",[\"$\",\"code\",\"9\",{\"children\":[\"all\"]}],\" \",[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"之类的函数来判断。\"]}]]}],[\"$\",\"$L1f\",\"47\",{\"className\":\"haskell\",\"children\":[\"dup :: [a] -\u003e [(a, a)]\\ndup xs = zip xs (tail xs)\\n\\ndown :: Ord a =\u003e [a] -\u003e Bool\\ndown = all (uncurry (\u003e=)) . dup\"]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"tick-的定义\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#tick-的定义\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"code\",\"0\",{\"children\":[\"tick\"]}],\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"的定义\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如果\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"已经满足了\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"down\"]}],[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"，换言之，它已经是最大的了，那么\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"x:xs\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"必须要进行比较复杂的操作才能得到下一个枚举。这个复杂的操作，被我称为\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"tick\"]}],\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"例如，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"[2, 4, 3, 1]\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"的下一个枚举是\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"[3, 1, 2, 4]\"]}],\".\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"这时\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"x\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"是\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"2\"]}],\",\",\" \",[\"$\",\"code\",\"8\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"9\",{\"className\":\"cjk\",\"children\":[\"是\"]}],\" \",[\"$\",\"code\",\"10\",{\"children\":[\"[4, 3, 1]\"]}],[\"$\",\"span\",\"11\",{\"className\":\"cjk\",\"children\":[\"，\"]}],[\"$\",\"code\",\"12\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"13\",{\"className\":\"cjk\",\"children\":[\"满足\"]}],\" \",[\"$\",\"code\",\"14\",{\"children\":[\"down\"]}],[\"$\",\"span\",\"15\",{\"className\":\"cjk\",\"children\":[\"，所以，这时不能再进行简单的递归，而要用\"]}],\" \",[\"$\",\"code\",\"16\",{\"children\":[\"tick\"]}],\" \",[\"$\",\"span\",\"17\",{\"className\":\"cjk\",\"children\":[\"进行计算。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"继续以\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"[2, 4, 3, 1]\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"为例。直觉上来讲，要求\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"[2, 4, 3, 1]\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"的下一个枚举\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"ys@(y:ys')\"]}],\",\",\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"可以分为两步：\"]}]]}],[\"$\",\"ul\",\"52\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"确定\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"y\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"是什么\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"确定\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"ys'\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"是什么\"]}]]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"首先，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"y\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"要严格大于\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"x\"]}],\".\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"因为我们已经表明，所有以\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"x\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"开头的枚举都要比\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"x:xs\"]}],\" \",[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"小。其次，\"]}],[\"$\",\"code\",\"9\",{\"children\":[\"y\"]}],\" \",[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"要尽可能小，不然会有更小的枚举\"]}],\" \",[\"$\",\"code\",\"11\",{\"children\":[\"p\"]}],\" \",[\"$\",\"span\",\"12\",{\"className\":\"cjk\",\"children\":[\"满足\"]}],\" \",[\"$\",\"code\",\"13\",{\"children\":[\"p \u003e x:xs\"]}],\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"上例中\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"y\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"是\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"3\"]}],\".\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"很容易想到，\"]}],[\"$\",\"code\",\"5\",{\"children\":[\"3\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"是\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"xs = [4, 3, 1]\"]}],\" \",[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"中，\"]}],[\"$\",\"strong\",\"9\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"最小的\"]}]]}],\" \",[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"大于\"]}],\" \",[\"$\",\"code\",\"11\",{\"children\":[\"x = 2\"]}],\" \",[\"$\",\"span\",\"12\",{\"className\":\"cjk\",\"children\":[\"的数。我们把这种数叫做\"]}],\" \",[\"$\",\"code\",\"13\",{\"children\":[\"pivot\"]}],\".\",\" \",[\"$\",\"span\",\"14\",{\"className\":\"cjk\",\"children\":[\"可以写出定义代码：\"]}]]}],[\"$\",\"$L1f\",\"55\",{\"className\":\"haskell\",\"children\":[\"pivot x xs = minumum [ x' | x' \u003c- xs, x' \u003e x  ]\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"注意到\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"是有序的，以上代码可以改写为\"]}]]}],[\"$\",\"$L1f\",\"57\",{\"className\":\"haskell\",\"children\":[\"pivot x = last . takeWhile (\u003e x)\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"需要指出的是，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"pivot\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"函数是一个偏函数，我们用了不安全的\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"last\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"和\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"minimum\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"操作，这意味着在调用时，必须保证至少存在一个\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"x' \u003e x\"]}],\".\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如果能够找到这样的\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"y \u003e x\"]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，那么我们就可以保证，\"]}],[\"$\",\"code\",\"3\",{\"children\":[\"y:ys'\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"绝对比\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"x:xs\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"大。所以，\"]}],[\"$\",\"code\",\"7\",{\"children\":[\"ys'\"]}],\" \",[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"的构造要使得\"]}],\" \",[\"$\",\"code\",\"9\",{\"children\":[\"y:ys'\"]}],\" \",[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"尽可能小。也就是说，\"]}],[\"$\",\"code\",\"11\",{\"children\":[\"ys'\"]}],\" \",[\"$\",\"span\",\"12\",{\"className\":\"cjk\",\"children\":[\"应该是最小的一个排列。和我们上面对于最大值的讨论一样，最小的排列就是单调递增的排列。这只需要排序即可。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"ys'\"]}],\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"中的元素自然是\"]}],\" \",[\"$\",\"code\",\"2\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"除掉\"]}],\" \",[\"$\",\"code\",\"4\",{\"children\":[\"y\"]}],\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"之后，再加上\"]}],\" \",[\"$\",\"code\",\"6\",{\"children\":[\"x\"]}],\".\",\" \",[\"$\",\"span\",\"7\",{\"className\":\"cjk\",\"children\":[\"例如，上面的例子\"]}],\" \",[\"$\",\"code\",\"8\",{\"children\":[\"[2, 4, 3, 1]\"]}],[\"$\",\"span\",\"9\",{\"className\":\"cjk\",\"children\":[\"，可以给出\"]}]]}],[\"$\",\"$L1f\",\"61\",{\"className\":\"haskell\",\"children\":[\"x:xs = [2, 4, 3, 1]\\n\\ny = last . takeWhile (\u003e x) $ xs\\n  = last [4, 3]\\n  = 3\\n\\nys'' = delete 3 xs\\n     = [4, 1]\\n\\nys' = sort (x:ys'')\\n    = sort [2, 4, 1]\\n    = [1, 2, 4]\\n\\nys = y:ys'\\n   = [3, 1, 2, 4]\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"最后，还需要讨论一种情况，那就是\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"pivot x xs = ⊥\"]}],\".\",\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"这种情况必须先行判断，以免出现错误。什么时候\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"pivot\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"不存在呢？那就是\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"x:xs\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"已经满足\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"down\"]}],\" \",[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"的时候，例如\"]}],\" \",[\"$\",\"code\",\"9\",{\"children\":[\"[4, 3, 2, 1]\"]}],[\"$\",\"span\",\"10\",{\"className\":\"cjk\",\"children\":[\"，这种时候，只需要把输入反转即可。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"根据以上讨论，我们给出\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"tick\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"函数的定义：\"]}]]}],[\"$\",\"$L1f\",\"64\",{\"className\":\"haskell\",\"children\":[\"import Data.List (delete)\\n\\ntick :: Ord a -\u003e a -\u003e [a] -\u003e [a]\\ntick x xs\\n    | null l    = reverse (x:xs)\\n    | otherwise = y:(sort (x:ys'))\\n    where l = takeWhile (\u003e x) xs\\n          y = last l\\n          ys' = delete y xs\"]}],[\"$\",\"$L1f\",\"65\",{\"className\":\"haskell\",\"children\":[\"\u003e tick 4 [3, 2, 1]\\n[1, 2, 3, 4]\\n\\n\u003e tick 2 [4, 3, 1]\\n[3, 1, 2, 4]\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"毫无疑问，目前的\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"函数已经能够正确地解决这个问题了。读者不妨把以上的\"]}],\" \",\"Haskell\",\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"代码翻译为\"]}],\" \",\"Scala，在\",\" \",\"Leetcode\",\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"里试一试。从递归出发，我们发现这个问题的解非常直觉，可以简单而轻松地给出。\"]}]]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"更高效的代码\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#更高效的代码\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"更高效的代码\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"上面定义的\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"函数虽然优雅直观，但是不够高效。主要的问题在于，\"]}]]}],[\"$\",\"ol\",\"69\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"tick\"]}],\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"中，不需要用到\"]}],\" \",[\"$\",\"code\",\"2\",{\"children\":[\"sort\"]}],\".\",\" \",[\"$\",\"code\",\"3\",{\"children\":[\"xs\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"是有序的，可以利用这点在\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003eO(n)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.02778em;\\\"\u003eO\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003en\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"内把新的有序序列组合起来\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"down\"]}],\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"被\"]}],\" \",[\"$\",\"code\",\"2\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"调用了好多次，每次调用都是\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003eO(n)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.02778em;\\\"\u003eO\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003en\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"的，导致总体复杂度出现了\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003eO(n^2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1.0641em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.02778em;\\\"\u003eO\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord\\\"\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003en\u003c/span\u003e\u003cspan class=\\\"msupsub\\\"\u003e\u003cspan class=\\\"vlist-t\\\"\u003e\u003cspan class=\\\"vlist-r\\\"\u003e\u003cspan class=\\\"vlist\\\" style=\\\"height:0.8141em;\\\"\u003e\u003cspan style=\\\"top:-3.063em;margin-right:0.05em;\\\"\u003e\u003cspan class=\\\"pstrut\\\" style=\\\"height:2.7em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"sizing reset-size6 size3 mtight\\\"\u003e\u003cspan class=\\\"mord mtight\\\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],\".\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"问题\"]}],\" \",\"1.\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"很简单，只需要重新写一下\"]}],\" \",[\"$\",\"code\",\"2\",{\"children\":[\"tick\"]}],\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"即可。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"问题\"]}],\" \",\"2.\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"比较麻烦。我们需要仔细观查一下计算的过程，例如\"]}],\" \",[\"$\",\"code\",\"2\",{\"children\":[\"next [3, 5, 1, 4, 2]\"]}],[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"：\"]}]]}],[\"$\",\"$L1f\",\"72\",{\"className\":\"haskell\",\"children\":[\"next [3, 5, 1, 4, 2]\\n= 3:(next [5, 1, 4, 2])\\n= 3:(5:(next [1, 4, 2]))\\n= 3:(5:(tick 1 [4, 2]))\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"可以看到，这个计算总是会具有一种\"]}],\" \",[\"$\",\"q\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"形状\"]}]]}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，那就是输入的前一部分保持不变，后一部分被\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"tick\"]}],\".\"]}],[\"$\",\"$L1f\",\"74\",{\"className\":\"haskell\",\"children\":[\"[3, 5,           1, 4, 2]\\n^^^^^^           #######\\n保持不变的部分     tick 的部分\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"而它们的分界线，直觉上来讲，就是\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"down\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"由\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"False\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"变为\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"True\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"的时刻。我们再回到\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"函数：\"]}]]}],[\"$\",\"$L1f\",\"76\",{\"className\":\"haskell\",\"children\":[\"next (x:xs)\\n    | down xs  = tick x xs\\n    | otherwise = x:next xs\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"在每次递归的时候，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"next (x:xs)\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"都会计算\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"down xs\"]}],[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"，再用刚才的例子，\"]}]]}],[\"$\",\"$L1f\",\"78\",{\"className\":\"haskell\",\"children\":[\"-- 第一次递归\\ndown [5, 1, 4, 2] = False\\n-- 第二次递归\\ndown [1, 4, 2]    = False\\n-- 第三次递归\\ndown [4, 2]       = True\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"事实上，\"]}],[\"$\",\"code\",\"1\",{\"children\":[\"down\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"每次都顺序地计算\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"tails\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"里的下一个元素：\"]}]]}],[\"$\",\"$L1f\",\"80\",{\"className\":\"haskell\",\"children\":[\"\u003e tails [3, 5, 1, 4, 2]\\n[[3,5,1,4,2],[5,1,4,2],[1,4,2],[4,2],[2],[]]\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"不妨把\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"next\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"每次用到的\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"down xs\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"提前\"]}],[\"$\",\"sup\",\"5\",{\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#note-2\",\"id\":\"note-anchor-2\",\"children\":[\"2\"]}]]}],[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"算出来，并放到一个列表里\"]}]]}],[\"$\",\"$L1f\",\"82\",{\"className\":\"haskell\",\"children\":[\"import Data.List (tails)\\n\\nnextDown (x:xs) (d:ds)\\n    | d = tick x xs\\n    | otherwise = x:nextDown xs ds\\n\\nnext xs = nextDown xs (downs xs)\\ndowns = drop 1 . map down . tails\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如果我们可以在\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003eO(n)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.02778em;\\\"\u003eO\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003en\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"时间内算出\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"downs\"]}],[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"，问题\"]}],\" \",\"2.\",\" \",[\"$\",\"span\",\"5\",{\"className\":\"cjk\",\"children\":[\"就迎刃而解了。直觉上来说，这是很容易的，因为\"]}],\" \",[\"$\",\"code\",\"6\",{\"children\":[\"down [4, 3, 2, 1]\"]}],\" \",[\"$\",\"span\",\"7\",{\"className\":\"cjk\",\"children\":[\"本来就是要保证：\"]}]]}],[\"$\",\"ul\",\"84\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"4 \u003e= 3\"]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"code\",\"0\",{\"children\":[\"down [3, 2, 1]\"]}]]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"换句话说，当我们要算\"]}],\" \",[\"$\",\"code\",\"1\",{\"children\":[\"down [4, 3, 2, 1]\"]}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"的时候，\"]}],[\"$\",\"code\",\"3\",{\"children\":[\"down [3, 2, 1]\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"已经被计算过了，只是需要一种方式把这种\"]}],\" \",[\"$\",\"q\",\"5\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"上一次的计算\"]}]]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"存起来以便后续使用。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"函数式编程社区早就有了对于这种问题的解决方法：\"]}],\" \",\"scan\",\" \",\"theorem.\"]}],[\"$\",\"p\",null,{\"children\":[\"Scan\",\" \",\"theorem\",\" \",[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"指的是\"]}]]}],[\"$\",\"$L1f\",\"88\",{\"className\":\"haskell\",\"children\":[\"map (foldl op a) . inits = scanl op a\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"类似地\"]}]]}],[\"$\",\"$L1f\",\"90\",{\"className\":\"haskell\",\"children\":[\"map (foldr op a) . tails = scanr op a\"]}],[\"$\",\"p\",null,{\"children\":[\"利用这个定理，我们给出以下程序计算过程.\",\" \",[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"注意，为了避免问题，我们定义了\"]}]]}],[\"$\",\"$L1f\",\"92\",{\"className\":\"haskell\",\"children\":[\"tails' = filter (not . null) . tails\"]}],[\"$\",\"$L1f\",\"93\",{\"className\":\"haskell\",\"children\":[\"downs = { definition }\\n        drop 1 . map down . tails'\\n      = { definition }\\n        drop 1 . map (all (uncurry (\u003e=)) . dup) . tails'\\n      = { map distributivity }\\n        drop 1 . map (all (uncurry (\u003e=))) . map dup . tails'\\n      = { need another proof (1) }\\n        drop 1 . map (all (uncurry (\u003e=))) . tails . dup\\n      = { definition }\\n        drop 1 . map (foldr (\u0026\u0026) True . map (uncurry (\u003e=))) . tails . dup\\n      = { fold-map fusion }\\n        drop 1 . map (foldr join True) . tails . dup\\n      = { scan theorem }\\n        drop 1 . scanr join True . dup\\n          where join (x, x1) r = x \u003e= x1 \u0026\u0026 r\"]}],[\"$\",\"ol\",\"94\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"需要一个新的证明，它指的是下面的代码是等价的：\"]}]]}]]}],[\"$\",\"$L1f\",\"95\",{\"className\":\"haskell\",\"children\":[\"\u003e map dup $ tails' [4, 2, 3, 1]\\n[[(4,2),(2,3),(3,1)],[(2,3),(3,1)],[(3,1)],[]]\\n\\n\u003e tails $ dup [4, 2, 3, 1]\\n[[(4,2),(2,3),(3,1)],[(2,3),(3,1)],[(3,1)],[]]\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"证明略去。\"]}]]}],[\"$\",\"h3\",null,{\"className\":\"text-2xl\",\"id\":\"总结\",\"children\":[[\"$\",\"$L1c\",null,{\"href\":\"#总结\",\"color\":\"secondary\",\"className\":\"pr-3 no-underline hover:underline text-primary font-sans\",\"children\":\"#\"}],[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"总结\"]}]]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"结合上面的讨论，我们可以给出高效的函数式实现：\"]}]]}],[\"$\",\"$L1f\",\"99\",{\"className\":\"haskell\",\"children\":[\"tick x xs = build l r x\\n    where (l, r) = span (\u003e x) xs\\n          build [] r x = reverse (x:r)\\n          build l  r x = last l : reverse (init l ++ [x] ++ r)\\n\\ndup xs = zip xs (tail xs)\\ndowns = scanr (\\\\(x, x1) r -\u003e (x \u003e= x1) \u0026\u0026 r) True . dup\\n\\nnext xs = l ++ tick (head r) (tail r)\\n    where (l, r) = splitAt (n - 1) xs\\n          n = length $ takeWhile not $ downs xs\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"这是\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eO\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003eO(n)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.02778em;\\\"\u003eO\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003en\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],\" \",[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"时间复杂度的。不过，我们的常数确实会比命令式程序大些。理论上来说，上一节定义的\"]}],\" \",[\"$\",\"code\",\"3\",{\"children\":[\"nextDown\"]}],\" \",[\"$\",\"span\",\"4\",{\"className\":\"cjk\",\"children\":[\"函数的实现要更高效一些（避免了\"]}],\" \",[\"$\",\"code\",\"5\",{\"children\":[\"length\"]}],\" \",[\"$\",\"span\",\"6\",{\"className\":\"cjk\",\"children\":[\"和\"]}],\" \",[\"$\",\"code\",\"7\",{\"children\":[\"splitAt\"]}],[\"$\",\"span\",\"8\",{\"className\":\"cjk\",\"children\":[\"），但是我仍然觉得本节给出的实现更清楚。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我把等价的\"]}],\" \",\"Scala\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"代码提交到了\"]}],\" \",\"leetcode:\"]}],[\"$\",\"$L1f\",\"102\",{\"className\":\"scala\",\"children\":[\"object Solution {\\n    def nextPermutation(nums: Array[Int]): Unit = {\\n        val nextNums = next(nums.toList).toArray\\n        for (i \u003c- nums.indices) {\\n            nums(i) = nextNums(i)\\n        }\\n    }\\n\\n    def dup(xs: List[Int]): List[(Int, Int)] = xs zip xs.drop(1)\\n\\n    def tick(x: Int, xs: List[Int]): List[Int] = {\\n        val (l, r) = xs.span(_ \u003e x)\\n        if (l.isEmpty) r.reverse ++ List(x)\\n        else l.last :: (l.init ++ List(x) ++ r).reverse\\n    }\\n\\n    def tailsDown(xs: List[(Int, Int)]): List[Boolean] = \\n        xs.scanRight(true) { case ((x, x1), r) =\u003e (x \u003e= x1) \u0026\u0026 r }\\n\\n    def next(xs: List[Int]): List[Int] = {\\n        val n = tailsDown(dup(xs)).takeWhile(!_).length\\n        val (l, r) = xs.splitAt(n - 1)\\n        l ++ tick(r.head, r.tail)\\n    }\\n}\"]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"q\",\"0\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"下一个排列\"]}]]}],\" \",\"问题是少有的命令式程序可以比函数式程序简洁的问题。甚至，Haskell\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"的\"]}],\" \",[\"$\",\"a\",\"2\",{\"href\":\"https://hackage.haskell.org/package/permutation-0.5.0.5/docs/Data-Permute.html\",\"children\":[\"Data.Permute\"]}],\" \",[\"$\",\"span\",\"3\",{\"className\":\"cjk\",\"children\":[\"库，也用了命令式的方法。\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"在命令式程序中，上面的算法可以被描述为两个过程：\"]}]]}],[\"$\",\"ol\",\"105\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"从右向左遍历，找到最长的下降序列\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e[\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e…\u003c/mo\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmtext\u003elen - 1\u003c/mtext\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003cmo stretchy=\\\"false\\\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003ea[i \\\\dots (\\\\text{len - 1})]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003ea\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003ei\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"minner\\\"\u003e…\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord text\\\"\u003e\u003cspan class=\\\"mord\\\"\u003elen - 1\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"进行计算，\"]}],[\"$\",\"ul\",\"1\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如果\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003ei = 0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:0.6595em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003ei\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mrel\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2778em;\\\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:0.6444em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord\\\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，那么反转数组\"]}]]}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"其他情况，找到\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"$20\"}}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，使得\"]}]]}],[\"$\",\"ul\",\"1\",{\"children\":[[\"$\",\"li\",\"0\",{\"children\":[[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"$21\"}}]]}],[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"$22\"}}]]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"交换\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo separator=\\\"true\\\"\u003e,\u003c/mo\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003ei - 1, j\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:0.7429em;vertical-align:-0.0833em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003ei\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mbin\\\"\u003e−\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.2222em;\\\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:0.854em;vertical-align:-0.1944em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"mpunct\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\" style=\\\"margin-right:0.05724em;\\\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}],[\"$\",\"span\",\"2\",{\"className\":\"cjk\",\"children\":[\"，反转\"]}],\" \",[\"$\",\"span\",null,{\"data-testid\":\"react-katex\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"katex\\\"\u003e\u003cspan class=\\\"katex-mathml\\\"\u003e\u003cmath xmlns=\\\"http://www.w3.org/1998/Math/MathML\\\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo stretchy=\\\"false\\\"\u003e[\u003c/mo\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e…\u003c/mo\u003e\u003cmo stretchy=\\\"false\\\"\u003e(\u003c/mo\u003e\u003cmtext\u003elen - 1\u003c/mtext\u003e\u003cmo stretchy=\\\"false\\\"\u003e)\u003c/mo\u003e\u003cmo stretchy=\\\"false\\\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\\\"application/x-tex\\\"\u003ea[i \\\\dots (\\\\text{len - 1})]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\\\"katex-html\\\" aria-hidden=\\\"true\\\"\u003e\u003cspan class=\\\"base\\\"\u003e\u003cspan class=\\\"strut\\\" style=\\\"height:1em;vertical-align:-0.25em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003ea\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"mord mathnormal\\\"\u003ei\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"minner\\\"\u003e…\u003c/span\u003e\u003cspan class=\\\"mspace\\\" style=\\\"margin-right:0.1667em;\\\"\u003e\u003c/span\u003e\u003cspan class=\\\"mopen\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"mord text\\\"\u003e\u003cspan class=\\\"mord\\\"\u003elen - 1\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"mclose\\\"\u003e)]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\"}}]]}]]}]]}]]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"如果读者完全理解了上面的函数式算法，这个命令式算法想必是非常直白的。但如果把这个算法直接端到你的面前喂给你，你真的能明白它为什么是正确的吗？\"]}]]}],[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"让我们用一个\"]}],\" \",\"Python\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"程序结束今天的故事吧！\"]}]]}],[\"$\",\"$L1f\",\"108\",{\"className\":\"python\",\"children\":[\"def swap(a, i, j):\\n    tmp = a[i]\\n    a[i] = a[j]\\n    a[j] = tmp\\n\\ndef rev(a, start, end):\\n    l = end - start\\n    for i in range(start, start + l // 2):\\n        swap(a, i, end - (i - start) - 1)\\n\\ndef solve(a):\\n    for i in range(len(a) - 1, -1, -1):\\n        if i \u003e= 1 and a[i - 1] \u003c a[i]:\\n            break\\n    if i == 0:\\n        rev(a, 0, len(a))\\n    else:\\n        j = len(a) - 1\\n        while j \u003e= i and a[j] \u003c= a[i - 1]:\\n            j -= 1\\n        swap(a, i - 1, j)\\n        rev(a, i, len(a))\"]}],[\"$\",\"div\",null,{\"className\":\"notes\",\"children\":[[\"$\",\"$L23\",null,{\"itemId\":\"1\",\"id\":\"note-1\",\"children\":[[\"$\",\"p\",null,{\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"我不清楚\"]}],\" \",\"Relational\",\" \",\"program\",\" \",\"calculus\",\" \",[\"$\",\"span\",\"1\",{\"className\":\"cjk\",\"children\":[\"是否能在这个题目上应用\"]}]]}]]}],[\"$\",\"$L23\",null,{\"itemId\":\"2\",\"id\":\"note-2\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"注意这不是精确的描述，Haskell\",\" \",[\"$\",\"span\",\"0\",{\"className\":\"cjk\",\"children\":[\"是惰性的，求值过程需要仔细分析\"]}]]}]]}]]}]]}]]}]]}]\n"])</script></body></html>